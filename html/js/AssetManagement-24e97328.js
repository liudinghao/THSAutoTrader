import{_ as E,i as h,k as F,E as _,r as m,G as N,o as p,f as w,H as B,a as I,w as r,b as n,d as a,I as A,F as $,m as z,t as i,p as u,u as C}from"./index-a0dcb939.js";import{i as G}from"./indexedDB-a78e6341.js";import{a as H,g as L}from"./asset-5fdc7043.js";import"./axios-3a665b0f.js";const S={class:"asset-management"},U={class:"card-header"},j={class:"asset-info-grid"},q={class:"label"},J={class:"card-header"},K={__name:"AssetManagement",setup(O){const l=h({asset:!1,position:!1}),g=h({}),v=h([]),M=async()=>{try{console.log("开始初始化 IndexedDB..."),await G.init(),console.log("IndexedDB 初始化成功")}catch(o){console.error("初始化数据库失败:",o),_.error("初始化数据库失败")}},b=async(o=!1)=>{if(!l.value.asset){l.value.asset=!0;try{const e=await H(o);g.value=e}catch(e){console.error("获取资产信息失败:",e),_.error(`获取资产信息失败: ${e.message}`)}finally{l.value.asset=!1}}},y=async(o=!1)=>{if(!l.value.position){l.value.position=!0;try{const e=await L(o);v.value=e}catch(e){console.error("获取持仓信息失败:",e),_.error(`获取持仓信息失败: ${e.message}`)}finally{l.value.position=!1}}},k=()=>{b(!0)},P=()=>{y(!0)};F(async()=>{try{await M(),await Promise.all([b(),y()])}catch(o){console.error("数据加载失败:",o),_.error("数据加载失败")}});const c=(o,e)=>{if(typeof e=="string"){const d=parseFloat(e.replace(/[^0-9.-]/g,""));if(o.includes("盈亏")||o.includes("盈亏比"))return d>0?"text-red":d<0?"text-green":""}return""};return(o,e)=>{const d=m("el-button"),x=m("el-card"),t=m("el-table-column"),V=m("el-table"),D=N("loading");return p(),w("div",S,[B((p(),I(x,{class:"asset-info-card","body-style":{padding:"20px"}},{header:r(()=>[n("div",U,[e[0]||(e[0]=n("span",null,"资产信息",-1)),a(d,{type:"primary",icon:A(C),circle:"",onClick:k,loading:l.value.asset},null,8,["icon","loading"])])]),default:r(()=>[n("div",j,[(p(!0),w($,null,z(g.value,(s,f)=>(p(),w("div",{key:f,class:"asset-info-item"},[n("span",q,i(f)+"：",1),n("span",{class:u(["value",c(f,s)])},i(s),3)]))),128))])]),_:1})),[[D,l.value.asset]]),B((p(),I(x,{class:"position-card","body-style":{padding:"20px"}},{header:r(()=>[n("div",J,[e[1]||(e[1]=n("span",null,"当前持仓",-1)),a(d,{type:"primary",icon:A(C),circle:"",onClick:P,loading:l.value.position},null,8,["icon","loading"])])]),default:r(()=>[a(V,{data:v.value,style:{width:"100%"},border:"",stripe:""},{default:r(()=>[a(t,{prop:"序号",label:"序号","min-width":"50"}),a(t,{prop:"证券代码",label:"证券代码","min-width":"80"}),a(t,{prop:"证券名称",label:"证券名称","min-width":"80"}),a(t,{prop:"股票余额",label:"股票余额","min-width":"80"}),a(t,{prop:"可用余额",label:"可用余额","min-width":"80"}),a(t,{prop:"成本价",label:"成本价","min-width":"80"}),a(t,{prop:"市价",label:"市价","min-width":"80"}),a(t,{prop:"盈亏",label:"盈亏","min-width":"80"},{default:r(s=>[n("span",{class:u(c("盈亏",s.row.盈亏))},i(s.row.盈亏),3)]),_:1}),a(t,{prop:"盈亏比例(%)",label:"盈亏比例(%)","min-width":"90"},{default:r(s=>[n("span",{class:u(c("盈亏比例",s.row["盈亏比例(%)"]))},i(s.row["盈亏比例(%)"]),3)]),_:1}),a(t,{prop:"当日盈亏",label:"当日盈亏","min-width":"80"},{default:r(s=>[n("span",{class:u(c("当日盈亏",s.row.当日盈亏))},i(s.row.当日盈亏),3)]),_:1}),a(t,{prop:"当日盈亏比(%)",label:"当日盈亏比(%)","min-width":"90"},{default:r(s=>[n("span",{class:u(c("当日盈亏比",s.row["当日盈亏比(%)"]))},i(s.row["当日盈亏比(%)"]),3)]),_:1}),a(t,{prop:"市值",label:"市值","min-width":"80"}),a(t,{prop:"仓位占比(%)",label:"仓位占比(%)","min-width":"90"}),a(t,{prop:"交易市场",label:"交易市场","min-width":"80"})]),_:1},8,["data"])]),_:1})),[[D,l.value.position]])])}}},X=E(K,[["__scopeId","data-v-6decc3a6"]]);export{X as default};
//# sourceMappingURL=AssetManagement-24e97328.js.map
