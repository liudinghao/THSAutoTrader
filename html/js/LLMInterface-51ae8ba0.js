import{_ as M,q as B,L as H,B as L,r as i,o as d,f as p,d as s,w as n,b as a,e as c,F as y,m as v,p as T,t as g,K as D,M as E,a as N}from"./index-a0dcb939.js";import{v as O,s as U}from"./llm-0ca868d8.js";const P={"deepseek-chat":{label:"DeepSeek-Chat",value:"deepseek-chat",description:"用于一般对话"},"deepseek-reasoner":{label:"DeepSeek-Reasoner",value:"deepseek-reasoner",description:"用于推理和复杂问题"},kimi:{label:"Kimi",value:"kimi",description:"月之暗面Kimi大模型，支持联网搜索"}},F={name:"LLMInterface",components:{Check:B,Setting:H,Delete:L},data(){return{config:{apiKey:"",model:"kimi",temperature:.7},messages:[],userInput:"",loading:!1,showConfig:!1,modelConfig:P}},created(){const t=localStorage.getItem("selected_model");t&&(this.config.model=t),this.loadApiKey(),this.loadHistory()},watch:{"config.model":{handler(t){localStorage.setItem("selected_model",t),this.loadApiKey()}},"config.apiKey":{handler(t){t&&this.saveApiKey()}},messages:{handler(t){this.saveHistory()},deep:!0}},methods:{saveApiKey(){if(!this.config.apiKey)return;const t=`api_key_${this.config.model}`;localStorage.setItem(t,this.config.apiKey)},loadApiKey(){const t=`api_key_${this.config.model}`,e=localStorage.getItem(t);this.config.apiKey=e||""},async validateApiKey(){if(!this.config.apiKey)return this.$message.error("请输入API密钥"),!1;try{return await O(this.config.apiKey,this.config.model),!0}catch(t){return this.$message.error("验证API密钥失败："+t.message),!1}},scrollToBottom(){this.$nextTick(()=>{const t=this.$refs.messagesContainer;t&&(t.scrollTop=t.scrollHeight)})},handleEnter(t){t.shiftKey?this.userInput+=`
`:this.sendMessage()},validateInput(){return this.userInput.trim()?!0:(this.$message.warning("请输入内容"),!1)},async sendMessage(){if(this.validateInput()&&await this.validateApiKey()){this.messages.push({role:"user",content:this.userInput.trim()}),this.userInput,this.userInput="",this.loading=!0,this.scrollToBottom();try{const t=await U(this.config.apiKey,this.config.model,this.messages,this.config.temperature);this.messages.push({role:"assistant",content:t.content}),this.scrollToBottom()}catch(t){this.$message.error("请求失败："+t.message)}finally{this.loading=!1}}},saveHistory(){const t=`chat_history_${this.config.model}`;localStorage.setItem(t,JSON.stringify(this.messages))},loadHistory(){const t=`chat_history_${this.config.model}`,e=localStorage.getItem(t);if(e)try{this.messages=JSON.parse(e)}catch(_){console.error("加载历史记录失败:",_),this.messages=[]}},clearHistory(){this.$confirm("确定要清空所有历史对话吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.messages=[],this.saveHistory(),this.$message.success("历史对话已清空")}).catch(()=>{})}}},J={class:"llm-interface"},j={class:"card-header"},q={class:"header-actions"},z={class:"chat-container"},G={class:"messages",ref:"messagesContainer"},R={class:"message-content"},Q={class:"input-area"},W={class:"model-description"},X={class:"dialog-footer"};function Y(t,e,_,Z,l,m){const k=i("Delete"),u=i("el-icon"),r=i("el-button"),K=i("Setting"),h=i("el-input"),C=i("el-card"),I=i("el-option"),w=i("el-select"),f=i("el-form-item"),V=i("Check"),b=i("el-slider"),S=i("el-form"),x=i("el-dialog");return d(),p("div",J,[s(C,{class:"chat-card"},{header:n(()=>[a("div",j,[e[10]||(e[10]=a("span",null,"对话",-1)),a("div",q,[s(r,{type:"danger",link:"",onClick:m.clearHistory},{default:n(()=>[s(u,null,{default:n(()=>[s(k)]),_:1}),e[8]||(e[8]=c(" 清空历史 "))]),_:1,__:[8]},8,["onClick"]),s(r,{type:"primary",link:"",onClick:e[0]||(e[0]=o=>l.showConfig=!0)},{default:n(()=>[s(u,null,{default:n(()=>[s(K)]),_:1}),e[9]||(e[9]=c(" 设置 "))]),_:1,__:[9]})])])]),default:n(()=>[a("div",z,[a("div",G,[(d(!0),p(y,null,v(l.messages,(o,A)=>(d(),p("div",{key:A,class:T(["message",o.role])},[a("div",R,g(o.content),1)],2))),128))],512),a("div",Q,[s(h,{modelValue:l.userInput,"onUpdate:modelValue":e[1]||(e[1]=o=>l.userInput=o),type:"textarea",rows:3,placeholder:"请输入您的问题... (按Enter发送，Shift+Enter换行)",onKeydown:D(E(m.handleEnter,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),s(r,{type:"primary",onClick:m.sendMessage,loading:l.loading},{default:n(()=>e[11]||(e[11]=[c(" 发送 ")])),_:1,__:[11]},8,["onClick","loading"])])])]),_:1}),s(x,{modelValue:l.showConfig,"onUpdate:modelValue":e[7]||(e[7]=o=>l.showConfig=o),title:"接口配置",width:"500px","close-on-click-modal":!1},{footer:n(()=>[a("span",X,[s(r,{onClick:e[5]||(e[5]=o=>l.showConfig=!1)},{default:n(()=>e[12]||(e[12]=[c("取消")])),_:1,__:[12]}),s(r,{type:"primary",onClick:e[6]||(e[6]=o=>l.showConfig=!1)},{default:n(()=>e[13]||(e[13]=[c(" 确定 ")])),_:1,__:[13]})])]),default:n(()=>[s(S,{model:l.config,"label-width":"120px"},{default:n(()=>[s(f,{label:"模型选择"},{default:n(()=>[s(w,{modelValue:l.config.model,"onUpdate:modelValue":e[2]||(e[2]=o=>l.config.model=o),placeholder:"请选择模型"},{default:n(()=>[(d(!0),p(y,null,v(Object.values(l.modelConfig),o=>(d(),N(I,{key:o.value,label:o.label,value:o.value},{default:n(()=>[a("span",null,g(o.label),1),a("span",W,g(o.description),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(f,{label:"API密钥"},{default:n(()=>[s(h,{modelValue:l.config.apiKey,"onUpdate:modelValue":e[3]||(e[3]=o=>l.config.apiKey=o),placeholder:"请输入API密钥","show-password":""},{append:n(()=>[s(r,{onClick:m.saveApiKey,disabled:!l.config.apiKey},{default:n(()=>[s(u,null,{default:n(()=>[s(V)]),_:1})]),_:1},8,["onClick","disabled"])]),_:1},8,["modelValue"])]),_:1}),s(f,{label:"温度"},{default:n(()=>[s(b,{modelValue:l.config.temperature,"onUpdate:modelValue":e[4]||(e[4]=o=>l.config.temperature=o),min:0,max:1,step:.1},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const te=M(F,[["render",Y],["__scopeId","data-v-841d4770"]]);export{te as default};
//# sourceMappingURL=LLMInterface-51ae8ba0.js.map
