const d="THSAutoTrader";const n={ASSET_INFO:"assetInfo",POSITION_DATA:"positionData",KLINE_DATA:"klineData"};class S{constructor(){this.db=null}async init(){return new Promise((t,r)=>{const o=indexedDB.open(d,2);o.onerror=s=>{r("数据库打开失败")},o.onsuccess=s=>{this.db=s.target.result,t()},o.onupgradeneeded=s=>{const e=s.target.result;e.objectStoreNames.contains(n.ASSET_INFO)||e.createObjectStore(n.ASSET_INFO,{keyPath:"id"}),e.objectStoreNames.contains(n.POSITION_DATA)||e.createObjectStore(n.POSITION_DATA,{keyPath:"id"}),e.objectStoreNames.contains(n.KLINE_DATA)||e.createObjectStore(n.KLINE_DATA,{keyPath:"code"})}})}async saveData(t,r,o=1){return this.db||await this.init(),new Promise((s,e)=>{const i=this.db.transaction([t],"readwrite").objectStore(t).put({[t===n.KLINE_DATA?"code":"id"]:o,data:r,timestamp:Date.now()});i.onsuccess=()=>s(),i.onerror=()=>e("数据保存失败")})}async getData(t,r=1){return this.db||await this.init(),new Promise((o,s)=>{const a=this.db.transaction([t],"readonly").objectStore(t).get(r);a.onsuccess=()=>o(a.result),a.onerror=()=>s("数据获取失败")})}isDataExpired(t,r=5*60*1e3){return!1}}const D=new S,u=n;export{u as S,D as i};
//# sourceMappingURL=indexedDB-6e3beb73.js.map
