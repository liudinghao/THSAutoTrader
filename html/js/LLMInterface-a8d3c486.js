import{_ as B,X as H,P as L,r as i,o as d,g as m,d as o,w as n,b as a,e as c,F as h,i as y,n as T,f as p,z as D,y as E,a as K}from"./index-14da2869.js";import{a as N}from"./llmService-e9940508.js";import"./llmConfig-57c9aed2.js";const O={"deepseek-chat":{label:"DeepSeek-Chat",value:"deepseek-chat",description:"用于一般对话"},"deepseek-reasoner":{label:"DeepSeek-Reasoner",value:"deepseek-reasoner",description:"用于推理和复杂问题"},kimi:{label:"Kimi",value:"kimi",description:"月之暗面Kimi大模型，支持联网搜索"}},U={name:"LLMInterface",components:{Setting:H,Delete:L},data(){return{config:{model:"kimi",temperature:.7},messages:[],userInput:"",loading:!1,showConfig:!1,modelConfig:O}},created(){const t=localStorage.getItem("selected_model");t&&(this.config.model=t),this.loadHistory()},watch:{"config.model":{handler(t){localStorage.setItem("selected_model",t)}},messages:{handler(t){this.saveHistory()},deep:!0}},methods:{scrollToBottom(){this.$nextTick(()=>{const t=this.$refs.messagesContainer;t&&(t.scrollTop=t.scrollHeight)})},handleEnter(t){t.shiftKey?this.userInput+=`
`:this.sendMessage()},validateInput(){return this.userInput.trim()?!0:(this.$message.warning("请输入内容"),!1)},async sendMessage(){if(this.validateInput()){this.messages.push({role:"user",content:this.userInput.trim()}),this.userInput,this.userInput="",this.loading=!0,this.scrollToBottom();try{const t=await N(this.messages,{provider:this.config.model==="kimi"?"kimi":"deepseek",model:this.config.model,temperature:this.config.temperature});this.messages.push({role:"assistant",content:t.content}),this.scrollToBottom()}catch(t){this.$message.error("请求失败："+t.message)}finally{this.loading=!1}}},saveHistory(){const t=`chat_history_${this.config.model}`;localStorage.setItem(t,JSON.stringify(this.messages))},loadHistory(){const t=`chat_history_${this.config.model}`,e=localStorage.getItem(t);if(e)try{this.messages=JSON.parse(e)}catch(_){console.error("加载历史记录失败:",_),this.messages=[]}},clearHistory(){this.$confirm("确定要清空所有历史对话吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.messages=[],this.saveHistory(),this.$message.success("历史对话已清空")}).catch(()=>{})}}},F={class:"llm-interface"},z={class:"card-header"},J={class:"header-actions"},j={class:"chat-container"},G={class:"messages",ref:"messagesContainer"},P={class:"message-content"},R={class:"input-area"},X={class:"model-description"},q={class:"dialog-footer"};function A(t,e,_,Q,l,u){const v=i("Delete"),f=i("el-icon"),r=i("el-button"),k=i("Setting"),C=i("el-input"),w=i("el-card"),I=i("el-option"),V=i("el-select"),g=i("el-form-item"),b=i("el-slider"),x=i("el-form"),S=i("el-dialog");return d(),m("div",F,[o(w,{class:"chat-card"},{header:n(()=>[a("div",z,[e[9]||(e[9]=a("span",null,"对话",-1)),a("div",J,[o(r,{type:"danger",link:"",onClick:u.clearHistory},{default:n(()=>[o(f,null,{default:n(()=>[o(v)]),_:1}),e[7]||(e[7]=c(" 清空历史 "))]),_:1,__:[7]},8,["onClick"]),o(r,{type:"primary",link:"",onClick:e[0]||(e[0]=s=>l.showConfig=!0)},{default:n(()=>[o(f,null,{default:n(()=>[o(k)]),_:1}),e[8]||(e[8]=c(" 设置 "))]),_:1,__:[8]})])])]),default:n(()=>[a("div",j,[a("div",G,[(d(!0),m(h,null,y(l.messages,(s,M)=>(d(),m("div",{key:M,class:T(["message",s.role])},[a("div",P,p(s.content),1)],2))),128))],512),a("div",R,[o(C,{modelValue:l.userInput,"onUpdate:modelValue":e[1]||(e[1]=s=>l.userInput=s),type:"textarea",rows:3,placeholder:"请输入您的问题... (按Enter发送，Shift+Enter换行)",onKeydown:D(E(u.handleEnter,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),o(r,{type:"primary",onClick:u.sendMessage,loading:l.loading},{default:n(()=>e[10]||(e[10]=[c(" 发送 ")])),_:1,__:[10]},8,["onClick","loading"])])])]),_:1}),o(S,{modelValue:l.showConfig,"onUpdate:modelValue":e[6]||(e[6]=s=>l.showConfig=s),title:"接口配置",width:"500px","close-on-click-modal":!1},{footer:n(()=>[a("span",q,[o(r,{onClick:e[4]||(e[4]=s=>l.showConfig=!1)},{default:n(()=>e[11]||(e[11]=[c("取消")])),_:1,__:[11]}),o(r,{type:"primary",onClick:e[5]||(e[5]=s=>l.showConfig=!1)},{default:n(()=>e[12]||(e[12]=[c(" 确定 ")])),_:1,__:[12]})])]),default:n(()=>[o(x,{model:l.config,"label-width":"120px"},{default:n(()=>[o(g,{label:"模型选择"},{default:n(()=>[o(V,{modelValue:l.config.model,"onUpdate:modelValue":e[2]||(e[2]=s=>l.config.model=s),placeholder:"请选择模型"},{default:n(()=>[(d(!0),m(h,null,y(Object.values(l.modelConfig),s=>(d(),K(I,{key:s.value,label:s.label,value:s.value},{default:n(()=>[a("span",null,p(s.label),1),a("span",X,p(s.description),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(g,{label:"温度"},{default:n(()=>[o(b,{modelValue:l.config.temperature,"onUpdate:modelValue":e[3]||(e[3]=s=>l.config.temperature=s),min:0,max:1,step:.1},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const $=B(U,[["render",A],["__scopeId","data-v-84f418ac"]]);export{$ as default};
//# sourceMappingURL=LLMInterface-a8d3c486.js.map
