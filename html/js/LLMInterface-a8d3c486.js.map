{"version":3,"file":"LLMInterface-a8d3c486.js","sources":["../../front/src/views/LLMInterface.vue"],"sourcesContent":["<template>\r\n  <div class=\"llm-interface\">\r\n    <el-card class=\"chat-card\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>对话</span>\r\n          <div class=\"header-actions\">\r\n            <el-button type=\"danger\" link @click=\"clearHistory\">\r\n              <el-icon><Delete /></el-icon>\r\n              清空历史\r\n            </el-button>\r\n            <el-button type=\"primary\" link @click=\"showConfig = true\">\r\n              <el-icon><Setting /></el-icon>\r\n              设置\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <div class=\"chat-container\">\r\n        <div class=\"messages\" ref=\"messagesContainer\">\r\n          <div v-for=\"(message, index) in messages\" :key=\"index\" \r\n               :class=\"['message', message.role]\">\r\n            <div class=\"message-content\">{{ message.content }}</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"input-area\">\r\n          <el-input\r\n            v-model=\"userInput\"\r\n            type=\"textarea\"\r\n            :rows=\"3\"\r\n            placeholder=\"请输入您的问题... (按Enter发送，Shift+Enter换行)\"\r\n            @keydown.enter.prevent=\"handleEnter\"\r\n          />\r\n          <el-button type=\"primary\" @click=\"sendMessage\" :loading=\"loading\">\r\n            发送\r\n          </el-button>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n\r\n    <!-- 配置弹窗 -->\r\n    <el-dialog\r\n      v-model=\"showConfig\"\r\n      title=\"接口配置\"\r\n      width=\"500px\"\r\n      :close-on-click-modal=\"false\"\r\n    >\r\n      <el-form :model=\"config\" label-width=\"120px\">\r\n        <el-form-item label=\"模型选择\">\r\n          <el-select v-model=\"config.model\" placeholder=\"请选择模型\">\r\n            <el-option\r\n              v-for=\"model in Object.values(modelConfig)\"\r\n              :key=\"model.value\"\r\n              :label=\"model.label\"\r\n              :value=\"model.value\"\r\n            >\r\n              <span>{{ model.label }}</span>\r\n              <span class=\"model-description\">{{ model.description }}</span>\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"温度\">\r\n          <el-slider v-model=\"config.temperature\" :min=\"0\" :max=\"1\" :step=\"0.1\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"showConfig = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"showConfig = false\">\r\n            确定\r\n          </el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Setting, Delete } from '@element-plus/icons-vue'\r\nimport { sendMessage } from '../services/llmService'\r\n\r\n// 模型配置\r\nconst MODEL_CONFIG = {\r\n  'deepseek-chat': {\r\n    label: 'DeepSeek-Chat',\r\n    value: 'deepseek-chat',\r\n    description: '用于一般对话'\r\n  },\r\n  'deepseek-reasoner': {\r\n    label: 'DeepSeek-Reasoner',\r\n    value: 'deepseek-reasoner',\r\n    description: '用于推理和复杂问题'\r\n  },\r\n  'kimi': {\r\n    label: 'Kimi',\r\n    value: 'kimi',\r\n    description: '月之暗面Kimi大模型，支持联网搜索'\r\n  },\r\n}\r\n\r\nexport default {\r\n  name: 'LLMInterface',\r\n  components: {\r\n    Setting,\r\n    Delete\r\n  },\r\n  data() {\r\n    return {\r\n      config: {\r\n        model: 'kimi',\r\n        temperature: 0.7\r\n      },\r\n      messages: [],\r\n      userInput: '',\r\n      loading: false,\r\n      showConfig: false,\r\n      modelConfig: MODEL_CONFIG\r\n    }\r\n  },\r\n  created() {\r\n    // 加载保存的模型选择\r\n    const savedModel = localStorage.getItem('selected_model')\r\n    if (savedModel) {\r\n      this.config.model = savedModel\r\n    }\r\n    this.loadHistory()\r\n  },\r\n  watch: {\r\n    'config.model': {\r\n      handler(newModel) {\r\n        // 保存模型选择\r\n        localStorage.setItem('selected_model', newModel)\r\n      }\r\n    },\r\n    messages: {\r\n      handler(newMessages) {\r\n        // 当消息更新时保存到本地存储\r\n        this.saveHistory()\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    scrollToBottom() {\r\n      this.$nextTick(() => {\r\n        const container = this.$refs.messagesContainer\r\n        if (container) {\r\n          container.scrollTop = container.scrollHeight\r\n        }\r\n      })\r\n    },\r\n    handleEnter(e) {\r\n      if (e.shiftKey) {\r\n        // Shift + Enter 换行\r\n        this.userInput += '\\n'\r\n      } else {\r\n        // 普通 Enter 发送消息\r\n        this.sendMessage()\r\n      }\r\n    },\r\n    validateInput() {\r\n      const content = this.userInput.trim()\r\n      if (!content) {\r\n        this.$message.warning('请输入内容')\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    async sendMessage() {\r\n      if (!this.validateInput()) return\r\n\r\n      // 添加用户消息\r\n      this.messages.push({\r\n        role: 'user',\r\n        content: this.userInput.trim()\r\n      })\r\n\r\n      const userMessage = this.userInput\r\n      this.userInput = ''\r\n      this.loading = true\r\n      this.scrollToBottom()\r\n\r\n      try {\r\n        const response = await sendMessage(\r\n          this.messages,\r\n          {\r\n            provider: this.config.model === 'kimi' ? 'kimi' : 'deepseek',\r\n            model: this.config.model,\r\n            temperature: this.config.temperature\r\n          }\r\n        )\r\n\r\n        this.messages.push({\r\n          role: 'assistant',\r\n          content: response.content\r\n        })\r\n        this.scrollToBottom()\r\n      } catch (error) {\r\n        this.$message.error('请求失败：' + error.message)\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    saveHistory() {\r\n      const key = `chat_history_${this.config.model}`\r\n      localStorage.setItem(key, JSON.stringify(this.messages))\r\n    },\r\n    loadHistory() {\r\n      const key = `chat_history_${this.config.model}`\r\n      const savedHistory = localStorage.getItem(key)\r\n      if (savedHistory) {\r\n        try {\r\n          this.messages = JSON.parse(savedHistory)\r\n        } catch (e) {\r\n          console.error('加载历史记录失败:', e)\r\n          this.messages = []\r\n        }\r\n      }\r\n    },\r\n    clearHistory() {\r\n      this.$confirm('确定要清空所有历史对话吗？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        this.messages = []\r\n        this.saveHistory()\r\n        this.$message.success('历史对话已清空')\r\n      }).catch(() => {})\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.llm-interface {\r\n  padding: 20px;\r\n}\r\n\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.chat-card {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  overflow: hidden;\r\n}\r\n\r\n.chat-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  overflow: hidden;\r\n}\r\n\r\n.messages {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: 20px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n  scroll-behavior: smooth;\r\n\r\n  &::-webkit-scrollbar {\r\n    width: 6px;\r\n  }\r\n\r\n  &::-webkit-scrollbar-thumb {\r\n    background-color: #dcdfe6;\r\n    border-radius: 3px;\r\n  }\r\n\r\n  &::-webkit-scrollbar-track {\r\n    background-color: transparent;\r\n  }\r\n}\r\n\r\n.message {\r\n  max-width: 80%;\r\n  \r\n  &.user {\r\n    align-self: flex-end;\r\n    .message-content {\r\n      background-color: #409EFF;\r\n      color: white;\r\n    }\r\n  }\r\n  \r\n  &.assistant {\r\n    align-self: flex-start;\r\n    .message-content {\r\n      background-color: #f4f4f5;\r\n    }\r\n  }\r\n}\r\n\r\n.message-content {\r\n  padding: 12px 16px;\r\n  border-radius: 8px;\r\n  word-break: break-word;\r\n  white-space: pre-wrap;\r\n}\r\n\r\n.input-area {\r\n  padding: 20px;\r\n  border-top: 1px solid #dcdfe6;\r\n  display: flex;\r\n  gap: 10px;\r\n  background-color: #fff;\r\n  \r\n  .el-button {\r\n    align-self: flex-end;\r\n  }\r\n}\r\n\r\n.dialog-footer {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 10px;\r\n}\r\n\r\n.model-description {\r\n  color: #909399;\r\n  font-size: 12px;\r\n  margin-left: 8px;\r\n}\r\n\r\n:deep(.el-select-dropdown__item) {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n}\r\n\r\n.header-actions {\r\n  display: flex;\r\n  gap: 16px;\r\n  align-items: center;\r\n}\r\n</style> "],"names":["MODEL_CONFIG","_sfc_main","Setting","Delete","savedModel","newModel","newMessages","container","e","response","sendMessage","error","key","savedHistory","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_openBlock","_createElementBlock","_createVNode","_component_el_card","_createElementVNode","_cache","_component_el_button","$options","_component_el_icon","_component_Delete","$data","_component_Setting","_hoisted_5","_Fragment","_renderList","message","index","_normalizeClass","_toDisplayString","_component_el_input","$event","_component_el_dialog","_component_el_form","_component_el_form_item","_component_el_select","model","_createBlock","_component_el_option","_component_el_slider"],"mappings":"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"}