{"version":3,"file":"asset-5fdc7043.js","sources":["../../front/src/api/asset.js"],"sourcesContent":["import axios from 'axios';\r\nimport { indexedDBUtil, STORE_NAMES } from '../utils/indexedDB';\r\n\r\nconst BASE_URL = 'http://localhost:5000';\r\n\r\n// 获取资产信息\r\nexport const getAssetInfo = async (forceRefresh = false) => {\r\n  try {\r\n    // 如果不是强制刷新，先尝试从缓存获取数据\r\n    if (!forceRefresh) {\r\n      const cachedData = await indexedDBUtil.getData(STORE_NAMES.ASSET_INFO);\r\n      if (cachedData && !indexedDBUtil.isDataExpired(cachedData.timestamp)) {\r\n        return cachedData.data;\r\n      }\r\n    }\r\n\r\n    // 从接口获取数据\r\n    const response = await axios.get(`${BASE_URL}/balance`);\r\n    if (response.data.status === 'success') {\r\n      const data = response.data.data;\r\n      // 保存到缓存\r\n      await indexedDBUtil.saveData(STORE_NAMES.ASSET_INFO, data);\r\n      return data;\r\n    }\r\n    throw new Error('接口返回状态异常');\r\n  } catch (error) {\r\n    console.error('获取资产信息失败:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// 获取持仓信息\r\nexport const getPositionData = async (forceRefresh = false) => {\r\n  try {\r\n    // 如果不是强制刷新，先尝试从缓存获取数据\r\n    if (!forceRefresh) {\r\n      const cachedData = await indexedDBUtil.getData(STORE_NAMES.POSITION_DATA);\r\n      if (cachedData && !indexedDBUtil.isDataExpired(cachedData.timestamp)) {\r\n        return cachedData.data;\r\n      }\r\n    }\r\n\r\n    // 从接口获取数据\r\n    const response = await axios.get(`${BASE_URL}/position`);\r\n    if (response.data.status === 'success') {\r\n      const data = response.data.data;\r\n      // 保存到缓存\r\n      await indexedDBUtil.saveData(STORE_NAMES.POSITION_DATA, data);\r\n      return data;\r\n    }\r\n    throw new Error('接口返回状态异常');\r\n  } catch (error) {\r\n    console.error('获取持仓信息失败:', error);\r\n    throw error;\r\n  }\r\n};\r\n"],"names":["BASE_URL","getAssetInfo","forceRefresh","cachedData","indexedDBUtil","STORE_NAMES","response","axios","data","error","getPositionData"],"mappings":"2FAGA,MAAMA,EAAW,wBAGJC,EAAe,MAAOC,EAAe,KAAU,CAC1D,GAAI,CAEF,GAAI,CAACA,EAAc,CACjB,MAAMC,EAAa,MAAMC,EAAc,QAAQC,EAAY,UAAU,EACrE,GAAIF,GAAc,CAACC,EAAc,cAAcD,EAAW,SAAS,EACjE,OAAOA,EAAW,IAErB,CAGD,MAAMG,EAAW,MAAMC,EAAM,IAAI,GAAGP,CAAQ,UAAU,EACtD,GAAIM,EAAS,KAAK,SAAW,UAAW,CACtC,MAAME,EAAOF,EAAS,KAAK,KAE3B,aAAMF,EAAc,SAASC,EAAY,WAAYG,CAAI,EAClDA,CACR,CACD,MAAM,IAAI,MAAM,UAAU,CAC3B,OAAQC,EAAO,CACd,cAAQ,MAAM,YAAaA,CAAK,EAC1BA,CACP,CACH,EAGaC,EAAkB,MAAOR,EAAe,KAAU,CAC7D,GAAI,CAEF,GAAI,CAACA,EAAc,CACjB,MAAMC,EAAa,MAAMC,EAAc,QAAQC,EAAY,aAAa,EACxE,GAAIF,GAAc,CAACC,EAAc,cAAcD,EAAW,SAAS,EACjE,OAAOA,EAAW,IAErB,CAGD,MAAMG,EAAW,MAAMC,EAAM,IAAI,GAAGP,CAAQ,WAAW,EACvD,GAAIM,EAAS,KAAK,SAAW,UAAW,CACtC,MAAME,EAAOF,EAAS,KAAK,KAE3B,aAAMF,EAAc,SAASC,EAAY,cAAeG,CAAI,EACrDA,CACR,CACD,MAAM,IAAI,MAAM,UAAU,CAC3B,OAAQC,EAAO,CACd,cAAQ,MAAM,YAAaA,CAAK,EAC1BA,CACP,CACH"}