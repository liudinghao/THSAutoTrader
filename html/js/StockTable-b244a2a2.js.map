{"version":3,"file":"StockTable-b244a2a2.js","sources":["../../front/src/components/StockKLine.vue","../../front/src/config/tagColors.js","../../front/src/components/ReasonTags.vue","../../front/src/components/stock/StockTable.vue"],"sourcesContent":["<template>\r\n  <div ref=\"chartRef\" class=\"kline-chart\"></div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onUnmounted, watch } from 'vue'\r\nimport * as echarts from 'echarts'\r\n\r\nexport default {\r\n  name: 'StockKLine',\r\n  props: {\r\n    code: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    klineData: {\r\n      type: Array,\r\n      required: true\r\n    }\r\n  },\r\n  setup(props) {\r\n    const chartRef = ref(null)\r\n    let chart = null\r\n\r\n    const initChart = () => {\r\n      if (chartRef.value) {\r\n        chart = echarts.init(chartRef.value)\r\n        window.addEventListener('resize', handleResize)\r\n      }\r\n    }\r\n\r\n    const handleResize = () => {\r\n      if (chart) {\r\n        chart.resize()\r\n      }\r\n    }\r\n\r\n    const updateChart = () => {\r\n      if (!chart || !props.klineData.length) return\r\n\r\n      const option = {\r\n        animation: false,\r\n        grid: {\r\n          left: '3%',\r\n          right: '3%',\r\n          bottom: '3%',\r\n          top: '3%',\r\n          containLabel: true\r\n        },\r\n        xAxis: {\r\n          type: 'category',\r\n          data: props.klineData.map(item => item.date),\r\n          scale: true,\r\n          boundaryGap: false,\r\n          axisLine: { onZero: false },\r\n          splitLine: { show: false },\r\n          axisLabel: { show: false },\r\n        },\r\n        yAxis: {\r\n          scale: true,\r\n          splitArea: {\r\n            show: true\r\n          },\r\n          axisLabel: { show: false }\r\n        },\r\n        series: [{\r\n          type: 'candlestick',\r\n          data: props.klineData.map(item => item.value),\r\n          itemStyle: {\r\n            color: '#ec0000',\r\n            color0: '#00da3c',\r\n            borderColor: '#8A0000',\r\n            borderColor0: '#008F28'\r\n          }\r\n        }]\r\n      }\r\n      \r\n      chart.setOption(option)\r\n    }\r\n\r\n    watch(() => props.klineData, () => {\r\n      updateChart()\r\n    }, { deep: true })\r\n\r\n    onMounted(() => {\r\n      initChart()\r\n      updateChart()\r\n    })\r\n\r\n    onUnmounted(() => {\r\n      if (chart) {\r\n        chart.dispose()\r\n        window.removeEventListener('resize', handleResize)\r\n      }\r\n    })\r\n\r\n    return {\r\n      chartRef\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.kline-chart {\r\n  width: 100%;\r\n  height: 60px;\r\n  min-width: 120px;\r\n}\r\n</style> ","// 基础颜色配置\r\nexport const baseColors = [\r\n  { h: 0, s: 100, l: 50 }, // 红色\r\n  { h: 120, s: 100, l: 50 }, // 绿色\r\n  { h: 240, s: 100, l: 50 }, // 蓝色\r\n  { h: 60, s: 100, l: 50 }, // 黄色\r\n  { h: 300, s: 100, l: 50 }, // 紫色\r\n  { h: 30, s: 100, l: 50 }, // 橙色\r\n  { h: 180, s: 100, l: 50 }, // 青色\r\n  { h: 330, s: 100, l: 50 }, // 粉色\r\n  { h: 270, s: 100, l: 50 }, // 靛蓝\r\n  { h: 150, s: 100, l: 50 }, // 深绿\r\n];\r\n\r\n// 标签颜色管理类\r\nexport class TagColorManager {\r\n  constructor() {\r\n    this.colorMap = new Map();\r\n    this.usedColors = new Set();\r\n    this.colorTypes = ['success', 'warning', 'danger', 'info', 'primary'];\r\n    this.colorIndex = 0;\r\n  }\r\n\r\n  // 获取标签类型\r\n  getTagColorClass(reason) {\r\n    // 如果已经分配过颜色，直接返回\r\n    if (this.colorMap.has(reason)) {\r\n      return this.colorMap.get(reason);\r\n    }\r\n\r\n    // 优先使用预定义的类型映射\r\n    const typeMap = {\r\n      // 概念相关\r\n      概念: 'success',\r\n      题材: 'success',\r\n      热点: 'success',\r\n\r\n      // 业绩相关\r\n      业绩: 'warning',\r\n      预增: 'warning',\r\n      扭亏: 'warning',\r\n      超预期: 'warning',\r\n\r\n      // 政策相关\r\n      政策: 'danger',\r\n      利好: 'danger',\r\n      支持: 'danger',\r\n\r\n      // 公告相关\r\n      公告: 'info',\r\n      披露: 'info',\r\n      回复: 'info',\r\n\r\n      // 其他类型\r\n      重组: 'primary',\r\n      收购: 'primary',\r\n      合作: 'primary',\r\n      投资: 'primary',\r\n      研发: 'primary',\r\n      技术: 'primary',\r\n    };\r\n\r\n    // 先尝试精确匹配\r\n    if (typeMap[reason]) {\r\n      this.colorMap.set(reason, typeMap[reason]);\r\n      return typeMap[reason];\r\n    }\r\n\r\n    // 再尝试模糊匹配\r\n    for (const [key, value] of Object.entries(typeMap)) {\r\n      if (reason.includes(key)) {\r\n        this.colorMap.set(reason, value);\r\n        return value;\r\n      }\r\n    }\r\n\r\n    // 如果没有预定义映射，分配一个循环颜色\r\n    const colorType = this.colorTypes[this.colorIndex % this.colorTypes.length];\r\n    this.colorMap.set(reason, colorType);\r\n    this.colorIndex++;\r\n\r\n    return colorType;\r\n  }\r\n\r\n  // 清除颜色映射（可选，用于重置）\r\n  clearColorMap() {\r\n    this.colorMap.clear();\r\n    this.colorIndex = 0;\r\n  }\r\n}\r\n\r\n// 创建单例实例\r\nexport const tagColorManager = new TagColorManager();\r\n","<template>\r\n  <div v-if=\"reasons && reasons.length\" class=\"reason-tags\">\r\n    <el-tag\r\n      v-for=\"(reason, index) in reasons\"\r\n      :key=\"index\"\r\n      :type=\"getReasonTagType(reason)\"\r\n      size=\"small\"\r\n      class=\"reason-tag\"\r\n    >\r\n      {{ reason }}\r\n    </el-tag>\r\n  </div>\r\n  <span v-else>--</span>\r\n</template>\r\n\r\n<script>\r\nimport { tagColorManager } from '../config/tagColors'\r\n\r\nexport default {\r\n  name: 'ReasonTags',\r\n  props: {\r\n    reasonType: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  computed: {\r\n    reasons() {\r\n      if (!this.reasonType) return []\r\n      return this.reasonType.split('+').map(r => r.trim()).filter(r => r)\r\n    }\r\n  },\r\n  methods: {\r\n    getReasonTagType(reason) {\r\n      return tagColorManager.getTagColorClass(reason)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.reason-tags {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: var(--spacing-mini);\r\n  justify-content: center;\r\n}\r\n\r\n.reason-tag {\r\n  margin: 0;\r\n}\r\n\r\n/* 确保标签颜色正确应用 */\r\n:deep(.el-tag--success) {\r\n  background-color: var(--tag-success-bg) !important;\r\n  border-color: var(--tag-success-border) !important;\r\n  color: var(--tag-success-color) !important;\r\n}\r\n\r\n:deep(.el-tag--warning) {\r\n  background-color: var(--tag-warning-bg) !important;\r\n  border-color: var(--tag-warning-border) !important;\r\n  color: var(--tag-warning-color) !important;\r\n}\r\n\r\n:deep(.el-tag--danger) {\r\n  background-color: var(--tag-danger-bg) !important;\r\n  border-color: var(--tag-danger-border) !important;\r\n  color: var(--tag-danger-color) !important;\r\n}\r\n\r\n:deep(.el-tag--info) {\r\n  background-color: var(--tag-info-bg) !important;\r\n  border-color: var(--tag-info-border) !important;\r\n  color: var(--tag-info-color) !important;\r\n}\r\n\r\n:deep(.el-tag--primary) {\r\n  background-color: var(--tag-primary-bg) !important;\r\n  border-color: var(--tag-primary-border) !important;\r\n  color: var(--tag-primary-color) !important;\r\n}\r\n</style> ","<template>\r\n  <el-table\r\n    :data=\"tableData\"\r\n    style=\"width: 100%\"\r\n    v-loading=\"loading\"\r\n    border\r\n    stripe\r\n    @row-click=\"handleRowClick\"\r\n    @sort-change=\"handleSortChange\"\r\n  >\r\n    <el-table-column label=\"股票信息\" min-width=\"65\">\r\n      <template #default=\"{ row }\">\r\n        <div class=\"stock-info\">\r\n          <span class=\"stock-name\">{{ row.name }}</span>\r\n          <span class=\"stock-code\">{{ row.code }}</span>\r\n          <span v-if=\"row.zttj_ct && row.zttj_days\" class=\"stock-zttj\">\r\n            <el-tag type=\"info\" size=\"small\">{{ row.zttj_ct }}/{{ row.zttj_days }}</el-tag>\r\n          </span>\r\n        </div>\r\n      </template>\r\n    </el-table-column>\r\n    \r\n    <el-table-column label=\"现价\" min-width=\"60\" align=\"right\">\r\n      <template #default=\"{ row }\">\r\n        <div v-if=\"row.price !== null && row.price !== undefined && !isNaN(row.price)\">\r\n          <span class=\"price\">{{ Number(row.price).toFixed(2) }}</span>\r\n        </div>\r\n        <span v-else>--</span>\r\n      </template>\r\n    </el-table-column>\r\n\r\n    <el-table-column prop=\"change\" label=\"涨跌幅\" min-width=\"70\" align=\"right\" sortable=\"custom\">\r\n      <template #default=\"{ row }\">\r\n        <div v-if=\"row.change !== null && row.change !== undefined && !isNaN(row.change)\">\r\n          <el-tag\r\n            :type=\"row.change > 0 ? 'danger' : row.change < 0 ? 'success' : 'info'\"\r\n            size=\"small\"\r\n          >\r\n            {{ row.change > 0 ? '+' : '' }}{{ Number(row.change).toFixed(2) }}%\r\n          </el-tag>\r\n        </div>\r\n        <span v-else>--</span>\r\n      </template>\r\n    </el-table-column>\r\n    \r\n    <el-table-column label=\"涨停原因\" prop=\"reason_type\" min-width=\"120\" align=\"center\" sortable=\"custom\">\r\n      <template #default=\"{ row }\">\r\n        <reason-tags :reason-type=\"row.reason_type\" />\r\n      </template>\r\n    </el-table-column>\r\n    \r\n    <el-table-column label=\"K线图\" min-width=\"130\" align=\"center\" v-if=\"showKLine\">\r\n      <template #default=\"{ row }\">\r\n        <stock-k-line \r\n          :code=\"row.code\" \r\n          :kline-data=\"row.klineData || []\"\r\n        />\r\n      </template>\r\n    </el-table-column>\r\n  </el-table>\r\n</template>\r\n\r\n<script>\r\nimport StockKLine from '../../components/StockKLine.vue'\r\nimport ReasonTags from '../../components/ReasonTags.vue'\r\n\r\nexport default {\r\n  name: 'StockTable',\r\n  components: {\r\n    StockKLine,\r\n    ReasonTags\r\n  },\r\n  props: {\r\n    tableData: {\r\n      type: Array,\r\n      required: true\r\n    },\r\n    loading: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    showKLine: {\r\n      type: Boolean,\r\n      default: true\r\n    }\r\n  },\r\n  emits: ['row-click', 'sort-change'],\r\n  methods: {\r\n    handleRowClick(row) {\r\n      this.$emit('row-click', row)\r\n    },\r\n    handleSortChange({ prop, order }) {\r\n      this.$emit('sort-change', { prop, order })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.stock-info {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.stock-name {\r\n  font-weight: 500;\r\n}\r\n\r\n.stock-code {\r\n  font-size: var(--font-size-small);\r\n  color: var(--info-color);\r\n}\r\n\r\n.price {\r\n  font-weight: 500;\r\n  margin-right: var(--spacing-small);\r\n}\r\n</style> "],"names":["_sfc_main","props","chartRef","ref","chart","initChart","echarts.init","handleResize","updateChart","option","item","watch","onMounted","onUnmounted","_openBlock","_createElementBlock","_hoisted_1","TagColorManager","reason","typeMap","key","value","colorType","tagColorManager","r","$options","_Fragment","_renderList","index","_createBlock","_component_el_tag","StockKLine","ReasonTags","row","prop","order","_hoisted_2","_hoisted_3","_hoisted_6","_component_el_table","$props","_createVNode","_component_el_table_column","_withCtx","_createElementVNode","_toDisplayString","_hoisted_4","_createTextVNode","_hoisted_5","_hoisted_8","_component_reason_tags","_component_stock_k_line"],"mappings":"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"}