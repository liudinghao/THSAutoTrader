const h={deepseek:{baseUrl:"https://api.deepseek.com/v1/chat/completions",headers:{"Content-Type":"application/json","X-API-Provider":"deepseek"}},kimi:{baseUrl:"//api.moonshot.cn/v1/chat/completions",headers:{"Content-Type":"application/json","X-API-Provider":"moonshot"}}};function l(s,a){const e=a||localStorage.getItem("selected_model")||"kimi",t=`api_key_${e}`,o=s||localStorage.getItem(t)||"";let r="deepseek";return e==="kimi"&&(r="kimi"),{apiKey:o,model:e,provider:r,baseUrl:h[r].baseUrl,headers:h[r].headers}}async function m(s,a){const e=l(s,a);console.log("config",e);const{apiKey:t,baseUrl:o,headers:r}=e;if(!t)throw new Error("Please enter API key");try{const i=await(await fetch(o,{method:"POST",headers:{...r,Authorization:`Bearer ${t}`},body:JSON.stringify({model:e.model==="kimi"?"moonshot-v1-8k":e.model,messages:[{role:"user",content:"test"}],max_tokens:5})})).json();if(i.error)throw i.error.code==="invalid_api_key"?new Error("Invalid API key, please check and try again"):new Error(i.error.message);return!0}catch(d){throw d}}async function y(s,a,e,t){const o=l(s,a),r=o.apiKey,d=o.baseUrl,i=o.headers;if(!r)throw new Error("Please enter API key");try{let n={};o.provider==="kimi"?n={model:"moonshot-v1-8k",messages:e,temperature:t,tools:[{type:"function",function:{name:"web_search",description:"Search the web for current information",parameters:{type:"object",properties:{query:{type:"string",description:"The search query"}},required:["query"]}}}],tool_choice:"auto"}:n={model:o.model,messages:e,temperature:t};const c=await(await fetch(d,{method:"POST",headers:{...i,Authorization:`Bearer ${r}`},body:JSON.stringify(n)})).json();if(c.error)throw new Error(c.error.message);if(!c.choices||!c.choices[0])throw new Error("Request failed");return c.choices[0].message}catch(n){throw n}}export{y as s,m as v};
//# sourceMappingURL=llm-0ca868d8.js.map
