{"version":3,"file":"MultiStockChart-94a84ed7.js","sources":["../../front/src/components/IntradayChart.vue","../../front/src/strategies/sellPointAnalysis.js","../../front/src/utils/common.js","../../front/src/strategies/pearsonCorrelation.js","../../front/src/views/MultiStockChart.vue"],"sourcesContent":["<template>\r\n  <div class=\"intraday-chart-container\">\r\n    <div v-if=\"loading\" class=\"loading-overlay\">\r\n      <el-loading-spinner />\r\n      <span>正在加载分时数据...</span>\r\n    </div>\r\n    <div ref=\"chartRef\" class=\"intraday-chart\" :style=\"{ height: height }\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted, watch, computed } from 'vue'\r\nimport * as echarts from 'echarts'\r\n\r\nconst props = defineProps({\r\n  stockData: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  loading: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  height: {\r\n    type: [String, Number],\r\n    default: '500px'\r\n  },\r\n  legendLabels: {\r\n    type: Object,\r\n    default: () => ({})\r\n  }\r\n})\r\n\r\nconst emit = defineEmits(['chartUpdate', 'chartClick', 'dataPointClick'])\r\n\r\nconst chartRef = ref(null)\r\nconst chart = ref(null)\r\n\r\n// 生成A股分时时间刻度，跳过午间休市时段（11:30-13:00）\r\nconst generateAStockTimeAxis = () => {\r\n  const pad = n => n.toString().padStart(2, '0')\r\n  const times = []\r\n  \r\n  // 上午 9:30~11:30\r\n  for (let h = 9, m = 30; h < 12;) {\r\n    times.push(`${pad(h)}:${pad(m)}:00`)\r\n    m++\r\n    if (m === 60) { h++; m = 0 }\r\n    if (h === 11 && m > 30) break\r\n  }\r\n  \r\n  // 下午 13:01~15:00\r\n  for (let h = 13, m = 1; h < 16;) {\r\n    times.push(`${pad(h)}:${pad(m)}:00`)\r\n    m++\r\n    if (m === 60) { h++; m = 0 }\r\n    if (h === 15 && m > 0) break\r\n  }\r\n  return times\r\n}\r\n\r\nconst timeAxis = generateAStockTimeAxis()\r\n\r\n// 股票颜色池 - 统一的颜色定义\r\nconst STOCK_COLOR_POOL = [\r\n  '#1890ff', '#f56c6c', '#67c23a', '#e6a23c', '#98D8C8',\r\n  '#ff7875', '#95de64', '#ffc53d', '#b37feb', '#ff85c0'\r\n]\r\n\r\n// 处理分时数据，支持JUNJIA均线\r\nconst processStockData = (stock) => {\r\n  if (!stock.minuteData || stock.minuteData.length === 0) {\r\n    return {\r\n      prices: [],\r\n      volumes: [],\r\n      avgPrice: [],\r\n      change: [],\r\n      changePercent: [],\r\n      junjia: [],\r\n      rawData: {}\r\n    }\r\n  }\r\n\r\n  const preClose = parseFloat(stock.preClose) || 0\r\n  \r\n  // 如果是新的数据格式（包含原始分时数据）\r\n  if (stock.rawData) {\r\n    const prices = []\r\n    const volumes = []\r\n    const avgPrice = []\r\n    const change = []\r\n    const changePercent = []\r\n    const junjia = []\r\n    timeAxis.forEach(time => {\r\n      const rawItem = stock.rawData[time]\r\n      if (rawItem) {\r\n        const newPrice = parseFloat(rawItem.NEW || 0)\r\n        const junjiaPrice = parseFloat(rawItem.JUNJIA || newPrice)\r\n        const volume = parseFloat(rawItem.VOL || 0)\r\n        \r\n        prices.push(newPrice)\r\n        junjia.push(junjiaPrice)\r\n        volumes.push(volume)\r\n        \r\n        if (preClose > 0) {\r\n          const pct = ((newPrice - preClose) / preClose) * 100\r\n          changePercent.push(parseFloat(pct.toFixed(2)))\r\n          change.push(parseFloat((newPrice - preClose).toFixed(3)))\r\n        } else {\r\n          changePercent.push(0)\r\n          change.push(0)\r\n        }\r\n      } else {\r\n        prices.push(null)\r\n        junjia.push(null)\r\n        volumes.push(null)\r\n        changePercent.push(null)\r\n        change.push(null)\r\n      }\r\n    })\r\n    return {\r\n      prices,\r\n      volumes,\r\n      avgPrice,\r\n      change,\r\n      changePercent,\r\n      junjia,\r\n      rawData: stock.rawData\r\n    }\r\n  }\r\n  \r\n  // 原有数据格式: [timeStr, changePercent]\r\n  const dataMap = new Map(stock.minuteData.map(item => [item[0], item[1]]))\r\n  \r\n  const prices = []\r\n  const volumes = []\r\n  const avgPrice = []\r\n  const change = []\r\n  const changePercent = []\r\n  const junjia = []\r\n  \r\n  timeAxis.forEach((time, index) => {\r\n    const changePct = dataMap.get(time)\r\n    \r\n    if (changePct !== undefined && changePct !== null) {\r\n      const pctValue = parseFloat(changePct)\r\n      changePercent.push(pctValue)\r\n      \r\n      // 根据涨跌幅反推价格\r\n      const price = preClose > 0 ? preClose * (1 + pctValue / 100) : 0\r\n      prices.push(parseFloat(price.toFixed(3)))\r\n      change.push(parseFloat((price - preClose).toFixed(3)))\r\n      junjia.push(parseFloat(price.toFixed(3))) // 简化的均线\r\n      \r\n      volumes.push(null) // 原数据没有成交量\r\n    } else {\r\n      prices.push(null)\r\n      junjia.push(null)\r\n      volumes.push(null)\r\n      changePercent.push(null)\r\n      change.push(null)\r\n    }\r\n  })\r\n  \r\n  return {\r\n    prices,\r\n    volumes,\r\n    avgPrice,\r\n    change,\r\n    changePercent,\r\n    junjia,\r\n    rawData: {}\r\n  }\r\n}\r\n\r\n// 处理多只股票的涨跌幅数据\r\nconst processMultiStockData = () => {\r\n  if (!props.stockData || props.stockData.length === 0) {\r\n    return {\r\n      mainStock: null,\r\n      otherStocks: []\r\n    }\r\n  }\r\n\r\n  const mainStock = processStockData(props.stockData[0])\r\n  const otherStocks = []\r\n\r\n  // 处理其他股票的涨跌幅数据\r\n  for (let i = 1; i < props.stockData.length; i++) {\r\n    const stock = props.stockData[i]\r\n    const processedData = processStockData(stock)\r\n    \r\n    otherStocks.push({\r\n      stock: stock,\r\n      changePercent: processedData.changePercent,\r\n      name: stock.name,\r\n      code: stock.code\r\n    })\r\n  }\r\n\r\n  return {\r\n    mainStock,\r\n    otherStocks\r\n  }\r\n}\r\n\r\n// 计算价格范围，确保与涨跌幅轴对齐\r\nconst calculatePriceRange = (prices, preClose, changeRange) => {\r\n  const validPrices = prices.filter(p => p !== null)\r\n  if (validPrices.length === 0) {\r\n    // 默认范围：昨收价上下5%\r\n    return { \r\n      min: preClose * 0.95, \r\n      max: preClose * 1.05,\r\n      center: preClose\r\n    }\r\n  }\r\n  return {\r\n    min: preClose * (1 + changeRange.min / 100),\r\n    max: preClose * (1 + changeRange.max / 100),\r\n    center: preClose\r\n  }\r\n}\r\n\r\n// 计算多股票涨跌幅范围 - 与价格轴同步\r\nconst calculateMultiStockChangeRange = (mainStock, otherStocks) => {\r\n  let allChanges = []\r\n  \r\n  // 添加主股票的涨跌幅\r\n  if (mainStock) {\r\n    allChanges = allChanges.concat(mainStock.changePercent.filter(c => c !== null))\r\n  }\r\n  \r\n  // 添加其他股票的涨跌幅\r\n  otherStocks.forEach(stockData => {\r\n    allChanges = allChanges.concat(stockData.changePercent.filter(c => c !== null))\r\n  })\r\n  \r\n  if (allChanges.length === 0) {\r\n    return { min: -5, max: 5 }\r\n  }\r\n  \r\n  const maxChange = Math.max(...allChanges)\r\n  const minChange = Math.min(...allChanges)\r\n  \r\n  // 取最大绝对值，确保对称，保证0轴居中\r\n  const maxAbsChange = Math.max(Math.abs(maxChange), Math.abs(minChange), 1) // 至少1%\r\n  const changePadding = maxAbsChange * 0.1\r\n  const finalMaxChange = maxAbsChange + changePadding\r\n  \r\n  return {\r\n    min: -finalMaxChange,\r\n    max: finalMaxChange\r\n  }\r\n}\r\n\r\n// 生成股票颜色\r\nconst generateStockColors = (count) => {\r\n  const result = []\r\n  for (let i = 0; i < count; i++) {\r\n    result.push(STOCK_COLOR_POOL[i % STOCK_COLOR_POOL.length])\r\n  }\r\n  return result\r\n}\r\n\r\n// 生成卖出标记点配置\r\nconst generateSellMarkPoint = (stock, timeAxis) => {\r\n  if (!stock.sellPoints || stock.sellPoints.length === 0) {\r\n    return null\r\n  }\r\n  \r\n  const markPointData = stock.sellPoints.map(sellPoint => {\r\n    // 找到卖点对应的时间索引\r\n    const timeIndex = timeAxis.findIndex(time => time === sellPoint.time)\r\n    if (timeIndex === -1) return null\r\n    \r\n    // 直接使用 sellPoint 的属性，无需 switch\r\n    const symbol = sellPoint.symbol || 'arrow'\r\n    const symbolRotate = sellPoint.symbolRotate || 0\r\n    const color = sellPoint.color || '#f56c6c'\r\n    const label = sellPoint.label || '卖点'\r\n    \r\n    return {\r\n      coord: [timeIndex, sellPoint.price],\r\n      value: sellPoint.price,\r\n      symbol: symbol,\r\n      symbolRotate: symbolRotate,\r\n      itemStyle: {\r\n        color: color\r\n      },\r\n      label: {\r\n        show: true,\r\n        formatter: label,\r\n        color: '#fff',\r\n        fontSize: 10,\r\n        fontWeight: 'bold',\r\n        backgroundColor: color,\r\n        padding: [2, 6],\r\n        borderRadius: 4,\r\n        position: 'top'\r\n      }\r\n    }\r\n  }).filter(item => item !== null)\r\n  \r\n  if (markPointData.length === 0) {\r\n    return null\r\n  }\r\n  \r\n  return {\r\n    symbolSize: 12,\r\n    data: markPointData\r\n  }\r\n}\r\n\r\n// 生成买入标记点配置\r\nconst generateBuyMarkPoint = (stock, timeAxis) => {\r\n  if (!stock.buyPoints || stock.buyPoints.length === 0) {\r\n    return null\r\n  }\r\n  \r\n  const markPointData = stock.buyPoints.map(buyPoint => {\r\n    // 找到买点对应的时间索引\r\n    const timeIndex = timeAxis.findIndex(time => time === buyPoint.time)\r\n    if (timeIndex === -1) return null\r\n    \r\n    // 直接使用 buyPoint 的属性\r\n    const symbol = buyPoint.symbol || 'arrow'\r\n    const symbolRotate = buyPoint.symbolRotate || 0\r\n    const color = buyPoint.color || '#ff4d4f'\r\n    const label = buyPoint.label || '买点'\r\n    \r\n    return {\r\n      coord: [timeIndex, buyPoint.price],\r\n      value: buyPoint.price,\r\n      symbol: symbol,\r\n      symbolRotate: symbolRotate,\r\n      itemStyle: {\r\n        color: color\r\n      },\r\n      label: {\r\n        show: true,\r\n        formatter: label,\r\n        color: '#fff',\r\n        fontSize: 10,\r\n        fontWeight: 'bold',\r\n        backgroundColor: color,\r\n        padding: [2, 6],\r\n        borderRadius: 4,\r\n        position: 'bottom'\r\n      }\r\n    }\r\n  }).filter(item => item !== null)\r\n  \r\n  if (markPointData.length === 0) {\r\n    return null\r\n  }\r\n  \r\n  return {\r\n    symbolSize: 12,\r\n    data: markPointData\r\n  }\r\n}\r\n\r\n// 更新专业分时图 - 支持多股票叠加\r\nconst updateProfessionalChart = () => {\r\n  if (!chart.value || !props.stockData?.length) return\r\n\r\n  const multiStockData = processMultiStockData()\r\n  const { mainStock, otherStocks } = multiStockData\r\n  \r\n  if (!mainStock) return\r\n\r\n  const stock = props.stockData[0]\r\n  const preClose = parseFloat(stock.preClose);\r\n  \r\n  // 计算多股票涨跌幅范围\r\n  const changeRange = calculateMultiStockChangeRange(mainStock, otherStocks)\r\n\r\n  // 计算价格范围(应该根据涨跌幅来计算)\r\n  const priceRange = calculatePriceRange(mainStock.prices, preClose, changeRange)\r\n\r\n  // 计算成交量范围\r\n  const validVolumes = mainStock.volumes.filter(v => v !== null && v > 0)\r\n  const maxVolume = validVolumes.length > 0 ? Math.max(...validVolumes) : 0\r\n  const volumeRange = {\r\n    max: maxVolume > 0 ? maxVolume * 1.2 : 1000\r\n  }\r\n\r\n  // 生成标记线 - 零轴线和昨收价线\r\n  const markLine = {\r\n    silent: true,\r\n    symbol: 'none',\r\n    label: {\r\n      show: false\r\n    },\r\n    lineStyle: {\r\n      color: '#000000',\r\n      width: 1,\r\n      type: 'solid'\r\n    },\r\n    data: [\r\n      {\r\n        yAxis: preClose,\r\n        lineStyle: { color: '#000000', width: 1 }\r\n      }\r\n    ]\r\n  }\r\n\r\n  // 生成组合标记点（买入+卖出信号）\r\n  const generateCombinedMarkPoint = (stock, timeAxis) => {\r\n    const sellMarks = generateSellMarkPoint(stock, timeAxis)\r\n    const buyMarks = generateBuyMarkPoint(stock, timeAxis)\r\n    \r\n    const combinedData = []\r\n    if (sellMarks?.data) {\r\n      combinedData.push(...sellMarks.data)\r\n    }\r\n    if (buyMarks?.data) {\r\n      combinedData.push(...buyMarks.data)\r\n    }\r\n    \r\n    if (combinedData.length === 0) {\r\n      return null\r\n    }\r\n    \r\n    return {\r\n      symbolSize: 12,\r\n      data: combinedData\r\n    }\r\n  }\r\n\r\n  // 获取自定义图例标签\r\n  const getLegendLabel = (stock, index = 0) => {\r\n    const key = `${stock.code}_${index}`\r\n    return props.legendLabels[key] || props.legendLabels[stock.code] || `${stock.name}(${stock.code})`\r\n  }\r\n\r\n  // 生成系列数据\r\n  const series = []\r\n  const stockColors = generateStockColors(1 + otherStocks.length)\r\n  \r\n  // 主股票的价格线\r\n  const mainLegendLabel = getLegendLabel(stock, 0)\r\n  series.push({\r\n    name: mainLegendLabel,\r\n    type: 'line',\r\n    data: mainStock.prices,\r\n    smooth: false,\r\n    symbol: 'none',\r\n    lineStyle: {\r\n      color: stockColors[0],\r\n      width: 2\r\n    },\r\n    itemStyle: {\r\n      color: stockColors[0]\r\n    },\r\n    markLine: markLine,\r\n    markPoint: generateCombinedMarkPoint(stock, timeAxis)\r\n  })\r\n  \r\n  // 主股票的均价线（不显示在图例中）\r\n  series.push({\r\n    name: `${stock.name}(${stock.code}) 均价`,\r\n    type: 'line',\r\n    data: mainStock.junjia,\r\n    smooth: false,\r\n    symbol: 'none',\r\n    lineStyle: {\r\n      color: '#FFB400',\r\n      width: 1,\r\n      type: 'solid'\r\n    },\r\n    itemStyle: {\r\n      color: '#FFB400'\r\n    },\r\n    legendHoverLink: false\r\n  })\r\n  \r\n  // 主股票的成交量（不显示在图例中）\r\n  series.push({\r\n    name: `${stock.name}(${stock.code}) 成交量`,\r\n    type: 'bar',\r\n    xAxisIndex: 1,\r\n    yAxisIndex: 2,\r\n    data: mainStock.volumes.map(v => v !== null ? v : 0),\r\n    itemStyle: {\r\n      color: function(params) {\r\n        const priceChange = mainStock.changePercent[params.dataIndex]\r\n        // 根据当前价格和上一分钟的价格来判断颜色，如果是第一个数据，则与昨收价比较\r\n        const currentPrice = mainStock.prices[params.dataIndex]\r\n        const previousPrice = params.dataIndex === 0 ? preClose : mainStock.prices[params.dataIndex - 1]\r\n        if (currentPrice > previousPrice) {\r\n          return '#f56c6c'\r\n        } else if (currentPrice < previousPrice) {\r\n          return '#67c23a'\r\n        } else {\r\n          return '#c5c5c5'\r\n        }\r\n      }\r\n    },\r\n    barWidth: '60%',\r\n    legendHoverLink: false\r\n  })\r\n  \r\n  // 其他股票的涨跌幅线\r\n  otherStocks.forEach((stockData, index) => {\r\n    series.push({\r\n      name: `${stockData.name}(${stockData.code})`,\r\n      type: 'line',\r\n      yAxisIndex: 1, // 使用右侧Y轴（涨跌幅轴）\r\n      data: stockData.changePercent,\r\n      smooth: false,\r\n      symbol: 'none',\r\n      lineStyle: {\r\n        color: stockColors[index + 1],\r\n        width: 1\r\n      },\r\n      itemStyle: {\r\n        color: stockColors[index + 1]\r\n      }\r\n    })\r\n  })\r\n\r\n  const option = {\r\n    animation: false,\r\n    title: {\r\n      show: false,\r\n      text: `${stock.name}(${stock.code}) 分时图${otherStocks.length > 0 ? ` + ${otherStocks.length}只股票对比` : ''}`,\r\n      left: 'center',\r\n      textStyle: {\r\n        fontSize: 16,\r\n        fontWeight: 'bold'\r\n      }\r\n    },\r\n    tooltip: {\r\n      show:false\r\n    },\r\n    legend: {\r\n      data: [\r\n        `${stock.name}(${stock.code})`,\r\n        ...otherStocks.map(s => `${s.name}(${s.code})`)\r\n      ],\r\n      top: 10,\r\n      textStyle: {\r\n        fontSize: 12\r\n      }\r\n    },\r\n    axisPointer: {\r\n      link: [\r\n        {\r\n          xAxisIndex: 'all'\r\n        }\r\n      ],\r\n      label: {\r\n        backgroundColor: '#777'\r\n      }\r\n    },\r\n    grid: [\r\n      {\r\n        left: '10%',\r\n        right: '8%',\r\n        height: '60%',\r\n        top: '10%'\r\n      },\r\n      {\r\n        left: '10%',\r\n        right: '8%',\r\n        top: '75%',\r\n        height: '15%'\r\n      }\r\n    ],\r\n    xAxis: [\r\n      {\r\n        type: 'category',\r\n        data: timeAxis,\r\n        boundaryGap: false,\r\n        axisLine: {\r\n          onZero: false,\r\n          lineStyle: { color: '#333' }\r\n        },\r\n        splitLine: {\r\n          show: true,\r\n          lineStyle: { color: '#f5f5f5' }\r\n        },\r\n        axisLabel: {\r\n          interval: function(index, value) {\r\n            // 在关键时间点显示标签\r\n            const time = value.substring(0, 5)\r\n            return ['09:30', '10:00', '10:30', '11:00', '11:30', '13:30', '14:00', '14:30', '15:00'].includes(time)\r\n          },\r\n          formatter: function(value) {\r\n            return value.substring(0, 5)\r\n          },\r\n          color: '#666'\r\n        },\r\n        axisTick: {\r\n          alignWithLabel: true\r\n        },\r\n        axisPointer: {\r\n          z: 100\r\n        },\r\n        splitArea: {\r\n          show: true,\r\n          areaStyle: {\r\n            color: ['rgba(250,250,250,0.3)', 'rgba(245,245,245,0.3)']\r\n          }\r\n        }\r\n      },\r\n      {\r\n        type: 'category',\r\n        gridIndex: 1,\r\n        data: timeAxis,\r\n        boundaryGap: false,\r\n        axisLine: {\r\n          onZero: false,\r\n          lineStyle: { color: '#333' }\r\n        },\r\n        axisTick: {\r\n          show: false\r\n        },\r\n        splitLine: {\r\n          show: false\r\n        },\r\n        axisLabel: {\r\n          show: false\r\n        }\r\n      }\r\n    ],\r\n    yAxis: [\r\n      {\r\n        type: 'value',\r\n        name: '价格',\r\n        axisLine: {\r\n          show: true,\r\n          lineStyle: { color: '#777' }\r\n        },\r\n        splitLine: {\r\n          show: true,\r\n          lineStyle: { color: '#eee', type: 'dashed' }\r\n        },\r\n        axisLabel: {\r\n          formatter: function(value) {\r\n            return value.toFixed(3)\r\n          },\r\n          color: '#333'\r\n        },\r\n        min: priceRange.min,\r\n        max: priceRange.max,\r\n        scale: true\r\n      },\r\n      {\r\n        type: 'value',\r\n        name: '涨跌幅',\r\n        position: 'right',\r\n        axisLine: {\r\n          show: true,\r\n          lineStyle: { color: '#777' }\r\n        },\r\n        splitLine: { show: false },\r\n        axisLabel: {\r\n          formatter: function(value) {\r\n            return value.toFixed(2) + '%'\r\n          },\r\n          color: function(value) {\r\n            return value > 0 ? '#f56c6c' : (value < 0 ? '#67c23a' : '#666')\r\n          }\r\n        },\r\n        min: changeRange.min,\r\n        max: changeRange.max,\r\n        scale: true\r\n      },\r\n      {\r\n        type: 'value',\r\n        name: '',\r\n        gridIndex: 1,\r\n        splitNumber: 2,\r\n        axisLabel: {\r\n          show: false\r\n        },\r\n        axisLine: {\r\n          show: false\r\n        },\r\n        axisTick: {\r\n          show: false\r\n        },\r\n        splitLine: {\r\n          show: false\r\n        },\r\n        min: 0,\r\n        max: volumeRange.max,\r\n        scale: true\r\n      }\r\n    ],\r\n    dataZoom: [\r\n      {\r\n        type: 'inside',\r\n        xAxisIndex: [0, 1],\r\n        start: 0,\r\n        end: 100\r\n      }\r\n    ],\r\n    series: series\r\n  }\r\n\r\n  chart.value.setOption(option, true)\r\n  emit('chartUpdate', { \r\n    option, \r\n    stockData: props.stockData, \r\n    processedData: multiStockData \r\n  })\r\n}\r\n\r\n\r\n\r\nconst updateChart = () => {\r\n  updateProfessionalChart()\r\n}\r\n\r\nconst resizeChart = () => {\r\n  if (chart.value) {\r\n    chart.value.resize()\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  if (chartRef.value) {\r\n    chart.value = echarts.init(chartRef.value)\r\n    \r\n    chart.value.on('click', (params) => {\r\n      emit('chartClick', params)\r\n    })\r\n    \r\n    chart.value.on('mouseover', (params) => {\r\n      emit('dataPointClick', params)\r\n    })\r\n    \r\n    updateChart()\r\n  }\r\n  \r\n  window.addEventListener('resize', resizeChart)\r\n})\r\n\r\nonUnmounted(() => {\r\n  if (chart.value) {\r\n    chart.value.dispose()\r\n  }\r\n  window.removeEventListener('resize', resizeChart)\r\n})\r\n\r\nwatch(() => props.stockData, (newVal, oldVal) => {\r\n  console.log('IntradayChart stockData 发生变化:', {\r\n    newLength: newVal?.length,\r\n    oldLength: oldVal?.length,\r\n    hasMinuteData: newVal?.some(stock => stock.minuteData && stock.minuteData.length > 0)\r\n  })\r\n  updateChart()\r\n}, { deep: true })\r\n\r\nwatch(() => props.height, () => {\r\n  resizeChart()\r\n})\r\n\r\ndefineExpose({\r\n  updateChart,\r\n  resizeChart,\r\n  getChartInstance: () => chart.value\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.intraday-chart-container {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.intraday-chart {\r\n  width: 100%;\r\n  height: 100%;\r\n  border: 1px solid #e4e7ed;\r\n  border-radius: 4px;\r\n  background: #fafafa;\r\n}\r\n\r\n.loading-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(255, 255, 255, 0.9);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 1000;\r\n  border-radius: 4px;\r\n}\r\n</style>","/**\r\n * 股票分时数据分析工具 - 卖出点检测\r\n * 基于量价关系逻辑：高位放量滞涨、首次回调、反弹乏力、尾盘破位\r\n */\r\n\r\n/**\r\n * 主分析函数 - 检测股票卖出点\r\n * @param {Object} stockData 股票分时数据对象\r\n * @param {Object} stockInfo 股票信息对象（如涨停价、跌停价、名称、代码等）\r\n *   - limitUpPrice: 涨停价\r\n *   - limitDownPrice: 跌停价\r\n *   - name: 股票名称（可选）\r\n *   - code: 股票代码（可选）\r\n *   - preClose: 昨收价（可选）\r\n *   - ...（可扩展更多字段）\r\n * @returns {Array} 分析结果数组\r\n */\r\nexport function analyzeSellPoints(\r\n  stockData,\r\n  stockInfo = {},\r\n  conceptPeersData = []\r\n) {\r\n  const sellPoints = []; // 卖出点数组\r\n  const summary = {\r\n    // 综合分析\r\n    riskLevel: 'low', // 风险等级: low, medium, high\r\n    sellSignals: 0, // 卖出信号数量\r\n    recommendations: [], // 建议列表\r\n  };\r\n\r\n  if (!stockData || typeof stockData !== 'object' || Array.isArray(stockData)) {\r\n    summary.recommendations.push('数据格式错误，需要对象格式');\r\n    return sellPoints;\r\n  }\r\n\r\n  // 对象格式转换为数组格式\r\n  const dataArray = Object.entries(stockData).map(([timestamp, data]) => ({\r\n    [timestamp]: data,\r\n  }));\r\n\r\n  if (dataArray.length === 0) {\r\n    summary.recommendations.push('数据为空，无法进行分析');\r\n    return sellPoints;\r\n  }\r\n\r\n  // --- 涨停价判断入口（可扩展） ---\r\n  const { limitUpPrice, limitDownPrice } = stockInfo;\r\n  if (limitUpPrice !== undefined) {\r\n    // 检查是否长时间处于涨停价，可在此处扩展特殊逻辑\r\n    const allAtLimitUp = dataArray.every((item) => {\r\n      const price = parseFloat(item[Object.keys(item)[0]].NEW);\r\n      return Math.abs(price - limitUpPrice) < 0.01;\r\n    });\r\n    if (allAtLimitUp) {\r\n      summary.recommendations.push('当前为涨停状态，常规卖出信号不适用');\r\n      summary.riskLevel = '低';\r\n      return { sellPoints, summary };\r\n    }\r\n  }\r\n\r\n  // --- 高位放量滞涨三维度检测 ---\r\n  const stagnationSellPoint = detectStagnation(\r\n    stockData,\r\n    stockInfo,\r\n    conceptPeersData\r\n  );\r\n  if (stagnationSellPoint) {\r\n    sellPoints.push(stagnationSellPoint);\r\n    summary.sellSignals++;\r\n    summary.recommendations.push('高位放量滞涨，建议全仓卖出');\r\n  }\r\n\r\n  // 1. 查找最高价点（可能的主力出货点）\r\n  let maxPrice = 0;\r\n  let maxPriceTime = 0;\r\n  let maxPriceIndex = 0;\r\n\r\n  dataArray.forEach((item, index) => {\r\n    const timestamp = Object.keys(item)[0];\r\n    const data = item[timestamp];\r\n    const price = parseFloat(data.NEW);\r\n    if (price > maxPrice) {\r\n      maxPrice = price;\r\n      maxPriceTime = parseInt(timestamp);\r\n      maxPriceIndex = index;\r\n    }\r\n  });\r\n\r\n  // 2. 高位放量滞涨检测（最高价附近成交量放大但价格停滞）\r\n  // 已由 detectStagnation 替代\r\n\r\n  // 3. 首次回调检测（从最高点回落1%以上）\r\n  for (let i = maxPriceIndex + 1; i < dataArray.length; i++) {\r\n    const currentTimestamp = Object.keys(dataArray[i])[0];\r\n    const currentData = dataArray[i][currentTimestamp];\r\n    const currentPrice = parseFloat(currentData.NEW);\r\n\r\n    if (currentPrice < maxPrice * 0.99) {\r\n      // 回落1%\r\n      sellPoints.push({\r\n        ...SELL_POINT_META['首次回调'],\r\n        type: '首次回调',\r\n        time: currentTimestamp,\r\n        price: currentPrice,\r\n        volume: currentData.VOL,\r\n        description: `从最高点${maxPrice}回落超过1%，短期见顶信号`,\r\n        signal: 'medium',\r\n        index: i,\r\n      });\r\n      summary.sellSignals++;\r\n      summary.recommendations.push('检测到首次回调，注意风险');\r\n      break;\r\n    }\r\n  }\r\n\r\n  // 4. 反弹乏力检测（反弹时成交量低于前高，动态窗口，最低点后首次反弹）\r\n  const hasFirstPullback = sellPoints.some(\r\n    (point) => point.type === '首次回调'\r\n  );\r\n  if (hasFirstPullback) {\r\n    const firstPullback = sellPoints.find((point) => point.type === '首次回调');\r\n    const firstPullbackIndex = firstPullback.index;\r\n    let minPrice = parseFloat(\r\n      dataArray[firstPullbackIndex][\r\n        Object.keys(dataArray[firstPullbackIndex])[0]\r\n      ].NEW\r\n    );\r\n    let minIndex = firstPullbackIndex;\r\n    // 1. 找到首次回调后的最低点\r\n    for (let i = firstPullbackIndex + 1; i < dataArray.length; i++) {\r\n      const price = parseFloat(dataArray[i][Object.keys(dataArray[i])[0]].NEW);\r\n      if (price < minPrice) {\r\n        minPrice = price;\r\n        minIndex = i;\r\n      }\r\n    }\r\n    // 2. 从最低点后，寻找首次反弹1%以上\r\n    for (let i = minIndex + 1; i < dataArray.length; i++) {\r\n      const price = parseFloat(dataArray[i][Object.keys(dataArray[i])[0]].NEW);\r\n      if (price >= minPrice * 1.01) {\r\n        // 反弹1%以上\r\n        const volume = parseFloat(\r\n          dataArray[i][Object.keys(dataArray[i])[0]].VOL\r\n        );\r\n        const baseVolume = parseFloat(\r\n          dataArray[maxPriceIndex][Object.keys(dataArray[maxPriceIndex])[0]].VOL\r\n        );\r\n        if (volume < baseVolume) {\r\n          sellPoints.push({\r\n            ...SELL_POINT_META['反弹乏力'],\r\n            type: '反弹乏力',\r\n            time: Object.keys(dataArray[i])[0],\r\n            price,\r\n            volume,\r\n            description: '反弹但成交量不足，买盘乏力',\r\n            signal: 'strong',\r\n            index: i,\r\n          });\r\n          summary.sellSignals++;\r\n          summary.recommendations.push('反弹乏力，建议卖出');\r\n        }\r\n        break; // 只检测一次\r\n      }\r\n    }\r\n  }\r\n\r\n  // 5. 尾盘破位检测（最后30分钟放量下跌）\r\n  const lastHourData = dataArray.slice(-30); // 假设每分钟1条数据\r\n  if (lastHourData.length > 0) {\r\n    const lastHourPrices = lastHourData.map((item) => {\r\n      const timestamp = Object.keys(item)[0];\r\n      return parseFloat(item[timestamp].NEW);\r\n    });\r\n    const lastHourVolumes = lastHourData.map((item) => {\r\n      const timestamp = Object.keys(item)[0];\r\n      return parseFloat(item[timestamp].VOL);\r\n    });\r\n\r\n    const avgLastHourPrice =\r\n      lastHourPrices.reduce((a, b) => a + b, 0) / lastHourPrices.length;\r\n    const avgLastHourVolume =\r\n      lastHourVolumes.reduce((a, b) => a + b, 0) / lastHourVolumes.length;\r\n\r\n    // 检测尾盘放量下跌（可多次出现）\r\n    for (let i = lastHourData.length - 1; i >= 0; i--) {\r\n      const currentTimestamp = Object.keys(lastHourData[i])[0];\r\n      const currentData = lastHourData[i][currentTimestamp];\r\n      const currentPrice = parseFloat(currentData.NEW);\r\n      const currentVolume = parseFloat(currentData.VOL);\r\n\r\n      if (\r\n        currentPrice < avgLastHourPrice * 0.99 && // 跌破平均价1%\r\n        currentVolume > avgLastHourVolume * 1.2\r\n      ) {\r\n        // 成交量放大20%\r\n        const originalIndex = dataArray.length - lastHourData.length + i;\r\n        sellPoints.push({\r\n          ...SELL_POINT_META['尾盘破位'],\r\n          type: '尾盘破位',\r\n          time: currentTimestamp,\r\n          price: currentPrice,\r\n          volume: currentVolume,\r\n          description: '尾盘放量破位，趋势转弱',\r\n          signal: 'strong',\r\n          index: originalIndex,\r\n        });\r\n        summary.sellSignals++;\r\n        summary.recommendations.push('尾盘破位，明日可能继续下跌');\r\n        // 不break，允许多次\r\n      }\r\n    }\r\n  }\r\n\r\n  // 5.1 盘中急跌放量（可多次出现）\r\n  for (let i = 5; i < dataArray.length; i++) {\r\n    const timestamp = Object.keys(dataArray[i])[0];\r\n    const data = dataArray[i][timestamp];\r\n    const price = parseFloat(data.NEW);\r\n    const volume = parseFloat(data.VOL);\r\n    const prevPrice = parseFloat(\r\n      dataArray[i - 1][Object.keys(dataArray[i - 1])[0]].NEW\r\n    );\r\n    const vol5 = calcMA(dataArray, i - 1, 5, 'VOL');\r\n    if (\r\n      price < prevPrice * 0.99 && // 跌幅大于1%\r\n      volume > vol5 * 1.5 // 成交量大于5均量1.5倍\r\n    ) {\r\n      sellPoints.push({\r\n        ...SELL_POINT_META['盘中急跌放量'],\r\n        type: '盘中急跌放量',\r\n        time: timestamp,\r\n        price,\r\n        volume,\r\n        description: '盘中急跌且放量，恐慌盘或主力砸盘',\r\n        signal: 'strong',\r\n        index: i,\r\n      });\r\n      summary.sellSignals++;\r\n      summary.recommendations.push('盘中急跌放量，短线需果断止损');\r\n      // 不break，允许多次\r\n    }\r\n  }\r\n\r\n  // 修正后的涨停打开且放量信号（可多次出现）\r\n  if (stockInfo && stockInfo.limitUpPrice !== undefined) {\r\n    for (let i = 1; i < dataArray.length; i++) {\r\n      const prevTimestamp = Object.keys(dataArray[i - 1])[0];\r\n      const prevData = dataArray[i - 1][prevTimestamp];\r\n      const prevPrice = parseFloat(prevData.NEW);\r\n      const timestamp = Object.keys(dataArray[i])[0];\r\n      const data = dataArray[i][timestamp];\r\n      const price = parseFloat(data.NEW);\r\n      const volume = parseFloat(data.VOL);\r\n      const vol5 = calcMA(dataArray, i - 1, 5, 'VOL');\r\n      // 前一分钟在涨停价（误差0.01元内），当前分钟低于涨停价0.01元且放量\r\n      if (\r\n        Math.abs(prevPrice - stockInfo.limitUpPrice) < 0.01 &&\r\n        price < stockInfo.limitUpPrice - 0.01 &&\r\n        volume > vol5 * 1.5\r\n      ) {\r\n        sellPoints.push({\r\n          ...SELL_POINT_META['涨停打开且放量'],\r\n          type: '涨停打开且放量',\r\n          time: timestamp,\r\n          price,\r\n          volume,\r\n          description: '涨停打开且放量，资金出逃',\r\n          signal: 'strong',\r\n          index: i,\r\n        });\r\n        summary.sellSignals++;\r\n        summary.recommendations.push('涨停打开且放量，短线需警惕回落风险');\r\n        // 不break，允许多次\r\n      }\r\n    }\r\n  }\r\n\r\n  // 6. 综合分析风险等级\r\n  if (summary.sellSignals >= 3) {\r\n    summary.riskLevel = '高';\r\n    summary.recommendations.push('多个卖出信号叠加，强烈建议减仓或清仓');\r\n  } else if (summary.sellSignals >= 2) {\r\n    summary.riskLevel = '中';\r\n    summary.recommendations.push('多个卖出信号，建议谨慎操作');\r\n  } else if (summary.sellSignals >= 1) {\r\n    summary.riskLevel = '低';\r\n    summary.recommendations.push('单个卖出信号，注意观察');\r\n  } else {\r\n    summary.recommendations.push('未检测到明显卖出信号，可继续持有');\r\n  }\r\n  return { sellPoints, summary };\r\n}\r\n\r\n// 计算N分钟均价或均量\r\nfunction calcMA(arr, idx, period, key) {\r\n  let sum = 0;\r\n  let count = 0;\r\n  for (let i = Math.max(0, idx - period + 1); i <= idx; i++) {\r\n    const timestamp = Object.keys(arr[i])[0];\r\n    sum += parseFloat(arr[i][timestamp][key]);\r\n    count++;\r\n  }\r\n  return count > 0 ? sum / count : 0;\r\n}\r\n\r\n// 高位放量滞涨三维度检测实现\r\n/**\r\n * 检查是否为高位放量滞涨\r\n * @param {Object} stockData - 分时数据对象，key为\"HH:mm:00\"\r\n * @param {Object} stockInfo - 股票信息对象，需含涨跌幅changePercent\r\n * @param {Array<Object>} conceptPeersData - 同板块其他股票的分时数据对象数组（可选）\r\n * @returns {Object|null} - 满足条件则返回卖点对象，否则返回null\r\n */\r\nfunction detectStagnation(stockData, stockInfo, conceptPeersData = []) {\r\n  const times = Object.keys(stockData).sort(); // 时间升序\r\n  const group5min = [];\r\n  for (let i = 0; i < times.length; i += 5) {\r\n    const group = times.slice(i, i + 5);\r\n    if (group.length === 5) group5min.push(group);\r\n  }\r\n  if (group5min.length < 3) return null; // 至少3个5分钟区间\r\n\r\n  // 计算每个5分钟区间的统计\r\n  const stats5min = group5min.map((group) => {\r\n    const prices = group.map((t) => parseFloat(stockData[t].NEW));\r\n    const vols = group.map((t) => parseFloat(stockData[t].VOL));\r\n    const moneys = group.map((t) => parseFloat(stockData[t].money));\r\n    return {\r\n      high: Math.max(...prices),\r\n      low: Math.min(...prices),\r\n      close: prices[4],\r\n      volume: vols.reduce((a, b) => a + b, 0),\r\n      money: moneys.reduce((a, b) => a + b, 0),\r\n      avgAmountPerTrade:\r\n        moneys.reduce((a, b) => a + b, 0) /\r\n        (vols.reduce((a, b) => a + b, 0) || 1),\r\n      startTime: group[0],\r\n      endTime: group[4],\r\n    };\r\n  });\r\n\r\n  // 当日5分钟均量\r\n  const avg5minVol =\r\n    stats5min.reduce((a, b) => a + b.volume, 0) / stats5min.length;\r\n\r\n  // 检查连续3个5分钟区间\r\n  for (let i = 2; i < stats5min.length; i++) {\r\n    // 价格横盘\r\n    const isLate = stats5min[i].endTime >= '14:50:00';\r\n    const priceCond = [i, i - 1, i - 2].every((idx) => {\r\n      const s = stats5min[idx];\r\n      const amp = (s.high - s.low) / s.low;\r\n      return (\r\n        amp <= (isLate ? 0.015 : 0.01) &&\r\n        s.close <=\r\n          Math.max(stats5min[idx - 1]?.high || 0, stats5min[idx - 2]?.high || 0)\r\n      );\r\n    });\r\n\r\n    // 成交量放量\r\n    const prevVol = stats5min[i - 1].volume;\r\n    const risePercent = stockInfo.changePercent || 0;\r\n    const volThreshold = risePercent >= 5 ? 1.5 : 2;\r\n    const volCond =\r\n      stats5min[i].volume >= prevVol * volThreshold &&\r\n      stats5min[i].volume >= avg5minVol * 3;\r\n\r\n    // 均额递减\r\n    const avgAmtCond =\r\n      stats5min[i].avgAmountPerTrade <\r\n        stats5min[i - 1].avgAmountPerTrade * 0.9 &&\r\n      stats5min[i - 1].avgAmountPerTrade <\r\n        stats5min[i - 2].avgAmountPerTrade * 0.9;\r\n\r\n    // 联动股确认（可选，需传入同板块数据）\r\n    let conceptCond = true;\r\n    if (conceptPeersData.length > 0) {\r\n      let peerCount = 0;\r\n      for (const peer of conceptPeersData) {\r\n        // 取peer的同一5分钟区间\r\n        const peerTimes = Object.keys(peer).sort();\r\n        const peerGroup5min = [];\r\n        for (let j = 0; j < peerTimes.length; j += 5) {\r\n          const group = peerTimes.slice(j, j + 5);\r\n          if (group.length === 5) peerGroup5min.push(group);\r\n        }\r\n        if (peerGroup5min.length > i) {\r\n          const group = peerGroup5min[i];\r\n          const prices = group.map((t) => parseFloat(peer[t].NEW));\r\n          const vols = group.map((t) => parseFloat(peer[t].VOL));\r\n          const moneys = group.map((t) => parseFloat(peer[t].money));\r\n          const high = Math.max(...prices);\r\n          const low = Math.min(...prices);\r\n          const amp = (high - low) / low;\r\n          const volume = vols.reduce((a, b) => a + b, 0);\r\n          const avg5minVolPeer =\r\n            peerGroup5min\r\n              .map((g) =>\r\n                g.map((t) => parseFloat(peer[t].VOL)).reduce((a, b) => a + b, 0)\r\n              )\r\n              .reduce((a, b) => a + b, 0) / peerGroup5min.length;\r\n          if (amp <= 0.01 && volume >= avg5minVolPeer * 3) peerCount++;\r\n        }\r\n      }\r\n      conceptCond = peerCount >= 2;\r\n    }\r\n\r\n    if (priceCond && volCond && avgAmtCond && conceptCond) {\r\n      // 满足条件，返回卖点\r\n      return {\r\n        ...SELL_POINT_META['高位放量滞涨'],\r\n        type: '高位放量滞涨',\r\n        time: stats5min[i].endTime,\r\n        price: stats5min[i].close,\r\n        volume: stats5min[i].volume,\r\n        description: '高位放量滞涨，三维度同步验证，主力出货',\r\n        signal: 'strong',\r\n        index: i,\r\n      };\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n// 卖点类型可视化属性映射表\r\nexport const SELL_POINT_META = {\r\n  高位放量滞涨: {\r\n    symbol: 'diamond',\r\n    symbolRotate: 0,\r\n    color: '#ff4d4f',\r\n    label: '高位滞涨',\r\n  },\r\n  首次回调: {\r\n    symbol: 'arrow',\r\n    symbolRotate: 180,\r\n    color: '#fa8c16',\r\n    label: '首次回调',\r\n  },\r\n  反弹乏力: {\r\n    symbol: 'circle',\r\n    symbolRotate: 0,\r\n    color: '#722ed1',\r\n    label: '反弹乏力',\r\n  },\r\n  尾盘破位: {\r\n    symbol: 'rect',\r\n    symbolRotate: 0,\r\n    color: '#eb2f96',\r\n    label: '尾盘破位',\r\n  },\r\n  盘中急跌放量: {\r\n    symbol: 'arrow',\r\n    symbolRotate: 270,\r\n    color: '#f5222d',\r\n    label: '急跌放量',\r\n  },\r\n  涨停打开且放量: {\r\n    symbol: 'star',\r\n    symbolRotate: 0,\r\n    color: '#faad14',\r\n    label: '涨停开板',\r\n  },\r\n  default: {\r\n    symbol: 'arrow',\r\n    symbolRotate: 180,\r\n    color: '#f56c6c',\r\n    label: '卖点',\r\n  },\r\n};\r\n","/**\r\n * 计算涨跌停价\r\n * @param {string} code 股票代码\r\n * @param {number} preClose 昨收价\r\n * @returns {{limitUpPrice: number, limitDownPrice: number}}\r\n */\r\nexport function getLimitPrices(code, preClose) {\r\n  if (!code || !preClose)\r\n    return { limitUpPrice: undefined, limitDownPrice: undefined };\r\n  const firstChar = String(code)[0];\r\n  const limitPercent = firstChar === '3' ? 0.2 : 0.1;\r\n  const limitUpPrice = +(preClose * (1 + limitPercent)).toFixed(2);\r\n  const limitDownPrice = +(preClose * (1 - limitPercent)).toFixed(2);\r\n  return { limitUpPrice, limitDownPrice };\r\n}\r\n","/**\r\n * 皮尔逊相关性算法\r\n * 计算两只股票分时数据的相似度\r\n */\r\n\r\n/**\r\n * 计算皮尔逊相关系数（基于涨跌幅数据）\r\n * @param {Array} data1 第一个股票的涨跌幅序列（百分比）\r\n * @param {Array} data2 第二个股票的涨跌幅序列（百分比）\r\n * @returns {number} 皮尔逊相关系数，范围在[-1, 1]之间\r\n */\r\nfunction calculatePearsonCorrelation(data1, data2) {\r\n  if (!Array.isArray(data1) || !Array.isArray(data2)) {\r\n    throw new Error('输入必须是数组');\r\n  }\r\n\r\n  if (data1.length !== data2.length) {\r\n    throw new Error('两个序列长度必须相同');\r\n  }\r\n\r\n  if (data1.length < 2) {\r\n    return 0;\r\n  }\r\n\r\n  // 过滤掉null/undefined/NaN值，只保留有效数字\r\n  const validPairs = [];\r\n  for (let i = 0; i < data1.length; i++) {\r\n    if (\r\n      data1[i] !== null &&\r\n      data2[i] !== null &&\r\n      data1[i] !== undefined &&\r\n      data2[i] !== undefined &&\r\n      typeof data1[i] === 'number' &&\r\n      typeof data2[i] === 'number' &&\r\n      !isNaN(data1[i]) &&\r\n      !isNaN(data2[i])\r\n    ) {\r\n      validPairs.push([data1[i], data2[i]]);\r\n    }\r\n  }\r\n\r\n  if (validPairs.length < 2) {\r\n    return 0;\r\n  }\r\n\r\n  const n = validPairs.length;\r\n\r\n  // 计算平均值\r\n  const sumX = validPairs.reduce((sum, pair) => sum + pair[0], 0);\r\n  const sumY = validPairs.reduce((sum, pair) => sum + pair[1], 0);\r\n  const meanX = sumX / n;\r\n  const meanY = sumY / n;\r\n\r\n  // 计算分子和分母\r\n  let numerator = 0;\r\n  let sumSquareX = 0;\r\n  let sumSquareY = 0;\r\n\r\n  for (let i = 0; i < n; i++) {\r\n    const [xi, yi] = validPairs[i];\r\n    const devX = xi - meanX;\r\n    const devY = yi - meanY;\r\n\r\n    numerator += devX * devY;\r\n    sumSquareX += devX * devX;\r\n    sumSquareY += devY * devY;\r\n  }\r\n\r\n  const denominator = Math.sqrt(sumSquareX * sumSquareY);\r\n\r\n  if (denominator === 0) {\r\n    return 0;\r\n  }\r\n\r\n  return numerator / denominator;\r\n}\r\n\r\n/**\r\n * 根据相关系数获取相似度标签\r\n * @param {number} correlation 皮尔逊相关系数\r\n * @returns {Object} 包含百分比相似度和标签的对象\r\n */\r\nfunction getCorrelationLabel(correlation) {\r\n  const absCorrelation = Math.abs(correlation);\r\n  let label = '';\r\n  let level = '';\r\n\r\n  if (absCorrelation >= 0.9) {\r\n    label = '极强相关';\r\n    level = 'extremely-strong';\r\n  } else if (absCorrelation >= 0.8) {\r\n    label = '强相关';\r\n    level = 'strong';\r\n  } else if (absCorrelation >= 0.6) {\r\n    label = '中等相关';\r\n    level = 'moderate';\r\n  } else if (absCorrelation >= 0.4) {\r\n    label = '弱相关';\r\n    level = 'weak';\r\n  } else if (absCorrelation >= 0.2) {\r\n    label = '极弱相关';\r\n    level = 'very-weak';\r\n  } else {\r\n    label = '不相关';\r\n    level = 'none';\r\n  }\r\n\r\n  // 计算百分比相似度（基于绝对值）\r\n  const similarity = Math.round(absCorrelation * 100);\r\n\r\n  return {\r\n    similarity,\r\n    label,\r\n    level,\r\n    correlation,\r\n    direction:\r\n      correlation > 0 ? 'positive' : correlation < 0 ? 'negative' : 'none',\r\n  };\r\n}\r\n\r\n/**\r\n * 标准化涨跌幅数据（相对于涨停幅度）\r\n * @param {Array} changePercent 涨跌幅数据\r\n * @param {number} limitUpPercent 涨停幅度（如20表示20%）\r\n * @returns {Array} 标准化后的涨跌幅比例\r\n */\r\nfunction normalizeChangePercent(changePercent, limitUpPercent = 10) {\r\n  if (!Array.isArray(changePercent) || changePercent.length === 0) {\r\n    return changePercent;\r\n  }\r\n\r\n  // 涨停幅度不能为0\r\n  const limit = Math.max(limitUpPercent, 0.01);\r\n\r\n  // 将涨跌幅除以涨停幅度，得到相对于涨停的比例\r\n  return changePercent.map((percent) => {\r\n    if (typeof percent !== 'number' || isNaN(percent)) {\r\n      return percent;\r\n    }\r\n    return (percent / limit) * 100; // 标准化为相对于涨停的百分比\r\n  });\r\n}\r\n\r\n/**\r\n * 计算两只股票分时数据的相似度\r\n * @param {Object} stock1 第一个股票的对象\r\n * @param {Object} stock2 第二个股票的对象\r\n * @param {string} dataType 数据类型：'prices'（价格）或 'changePercent'（涨跌幅）\r\n * @param {boolean} normalize 是否标准化涨跌幅（按涨停幅度）\r\n * @param {boolean} includePrevious 是否包含上一日相似度\r\n * @returns {Object} 相似度分析结果\r\n */\r\nexport function calculateStockSimilarity(\r\n  stock1,\r\n  stock2,\r\n  dataType = 'changePercent',\r\n  normalize = true,\r\n  includePrevious = true\r\n) {\r\n  if (!stock1 || !stock2) {\r\n    throw new Error('必须提供两个股票对象');\r\n  }\r\n\r\n  let data1, data2;\r\n  let prevData1, prevData2;\r\n\r\n  switch (dataType) {\r\n    case 'prices':\r\n      data1 = stock1.prices || [];\r\n      data2 = stock2.prices || [];\r\n      prevData1 = stock1.prevPrices || [];\r\n      prevData2 = stock2.prevPrices || [];\r\n      break;\r\n    case 'changePercent':\r\n      data1 = stock1.changePercent || [];\r\n      data2 = stock2.changePercent || [];\r\n      prevData1 = stock1.prevChangePercent || [];\r\n      prevData2 = stock2.prevChangePercent || [];\r\n\r\n      // 标准化涨跌幅数据（按涨停幅度）\r\n      if (normalize) {\r\n        const limit1 = stock1.limitUpPercent || 10;\r\n        const limit2 = stock2.limitUpPercent || 10;\r\n        data1 = normalizeChangePercent(data1, limit1);\r\n        data2 = normalizeChangePercent(data2, limit2);\r\n        prevData1 = normalizeChangePercent(prevData1, limit1);\r\n        prevData2 = normalizeChangePercent(prevData2, limit2);\r\n      }\r\n      break;\r\n    default:\r\n      throw new Error('数据类型必须是 prices 或 changePercent');\r\n  }\r\n\r\n  if (data1.length === 0 || data2.length === 0) {\r\n    console.log('数据为空，返回0%');\r\n    return {\r\n      correlation: 0,\r\n      similarity: 0,\r\n      label: '无数据',\r\n      level: 'none',\r\n      direction: 'none',\r\n      validDataPoints: 0,\r\n      totalDataPoints: Math.max(data1.length, data2.length),\r\n    };\r\n  }\r\n\r\n  try {\r\n    const correlation = calculatePearsonCorrelation(data1, data2);\r\n    const result = getCorrelationLabel(correlation);\r\n\r\n    // 计算上一日相似度\r\n    let prevCorrelation = null;\r\n    let prevSimilarity = null;\r\n    let prevLabel = null;\r\n\r\n    if (includePrevious && prevData1.length > 0 && prevData2.length > 0) {\r\n      try {\r\n        const prevCorr = calculatePearsonCorrelation(prevData1, prevData2);\r\n        const prevResult = getCorrelationLabel(prevCorr);\r\n        prevCorrelation = prevCorr;\r\n        prevSimilarity = prevResult.similarity;\r\n        prevLabel = prevResult.label;\r\n      } catch (prevError) {\r\n        console.warn('计算上一日相似度失败:', prevError.message);\r\n      }\r\n    }\r\n\r\n    // 计算有效数据点\r\n    const validDataPoints = data1.filter(\r\n      (val, idx) =>\r\n        val !== null &&\r\n        data2[idx] !== null &&\r\n        typeof val === 'number' &&\r\n        typeof data2[idx] === 'number' &&\r\n        !isNaN(val) &&\r\n        !isNaN(data2[idx])\r\n    ).length;\r\n\r\n    return {\r\n      ...result,\r\n      prevCorrelation,\r\n      prevSimilarity,\r\n      prevLabel,\r\n      validDataPoints,\r\n      totalDataPoints: data1.length,\r\n      dataType,\r\n      hasPreviousData: prevData1.length > 0 && prevData2.length > 0,\r\n    };\r\n  } catch (error) {\r\n    console.error('计算股票相似度失败:', error);\r\n    return {\r\n      correlation: 0,\r\n      similarity: 0,\r\n      prevCorrelation: null,\r\n      prevSimilarity: null,\r\n      prevLabel: null,\r\n      label: '计算错误',\r\n      level: 'error',\r\n      direction: 'none',\r\n      validDataPoints: 0,\r\n      totalDataPoints: Math.max(data1.length, data2.length),\r\n      error: error.message,\r\n      hasPreviousData: false,\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * 计算多只股票之间的相似度矩阵\r\n * @param {Array} stocks 股票数组\r\n * @param {string} dataType 数据类型：'prices' 或 'changePercent'\r\n * @param {boolean} normalize 是否标准化涨跌幅（按涨停幅度）\r\n * @param {boolean} includePrevious 是否包含上一日相似度\r\n * @returns {Array} 相似度矩阵\r\n */\r\nexport function calculateSimilarityMatrix(\r\n  stocks,\r\n  dataType = 'changePercent',\r\n  normalize = true,\r\n  includePrevious = true\r\n) {\r\n  if (!Array.isArray(stocks) || stocks.length < 2) {\r\n    return [];\r\n  }\r\n\r\n  const matrix = [];\r\n\r\n  for (let i = 0; i < stocks.length; i++) {\r\n    const row = [];\r\n    for (let j = 0; j < stocks.length; j++) {\r\n      if (i === j) {\r\n        row.push({\r\n          correlation: 1,\r\n          similarity: 100,\r\n          label: '完全相同',\r\n          level: 'perfect',\r\n          direction: 'positive',\r\n          validDataPoints: 0,\r\n          totalDataPoints: 0,\r\n          stock1: stocks[i],\r\n          stock2: stocks[j],\r\n        });\r\n      } else {\r\n        const similarity = calculateStockSimilarity(\r\n          stocks[i],\r\n          stocks[j],\r\n          dataType,\r\n          normalize,\r\n          includePrevious\r\n        );\r\n        row.push({\r\n          ...similarity,\r\n          stock1: stocks[i],\r\n          stock2: stocks[j],\r\n        });\r\n      }\r\n    }\r\n    matrix.push(row);\r\n  }\r\n\r\n  return matrix;\r\n}\r\n\r\n/**\r\n * 获取最相似的股票对\r\n * @param {Array} stocks 股票数组\r\n * @param {string} dataType 数据类型：'prices' 或 'changePercent'\r\n * @param {number} minSimilarity 最小相似度阈值（0-100）\r\n * @param {boolean} normalize 是否标准化涨跌幅（按涨停幅度）\r\n * @param {boolean} includePrevious 是否包含上一日相似度\r\n * @returns {Array} 排序后的相似股票对\r\n */\r\nexport function getMostSimilarStocks(\r\n  stocks,\r\n  dataType = 'changePercent',\r\n  minSimilarity = 60,\r\n  normalize = true,\r\n  includePrevious = true\r\n) {\r\n  if (!Array.isArray(stocks) || stocks.length < 2) {\r\n    return [];\r\n  }\r\n\r\n  const similarities = [];\r\n\r\n  for (let i = 0; i < stocks.length; i++) {\r\n    for (let j = i + 1; j < stocks.length; j++) {\r\n      const similarity = calculateStockSimilarity(\r\n        stocks[i],\r\n        stocks[j],\r\n        dataType,\r\n        normalize,\r\n        includePrevious\r\n      );\r\n      if (similarity.similarity >= minSimilarity) {\r\n        similarities.push({\r\n          ...similarity,\r\n          stock1: stocks[i],\r\n          stock2: stocks[j],\r\n          pairIndex: [i, j],\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  // 按相似度降序排序\r\n  return similarities.sort((a, b) => b.similarity - a.similarity);\r\n}\r\n\r\n// 导出剩余的函数（其他函数已在前面用 export function 导出）\r\nexport {\r\n  calculatePearsonCorrelation,\r\n  getCorrelationLabel,\r\n};\r\n","<template>\r\n  <div class=\"multi-stock-chart\">\r\n    <!-- 页面头部 -->\r\n    <div class=\"header\">\r\n      <h2>相似度分析</h2>\r\n      <div class=\"header-controls\">\r\n        <el-date-picker\r\n          v-model=\"currentDate\"\r\n          type=\"date\"\r\n          placeholder=\"选择日期\"\r\n          format=\"YYYY-MM-DD\"\r\n          value-format=\"YYYYMMDD\"\r\n          style=\"width: 150px; margin-right: 10px\"\r\n          @change=\"onDateChange\"\r\n        />\r\n        <el-button \r\n          type=\"primary\" \r\n          size=\"small\" \r\n          :loading=\"isLoading\"\r\n          @click=\"refreshData\"\r\n        >\r\n          <el-icon><Refresh /></el-icon>\r\n          刷新数据\r\n        </el-button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 股票选择器 -->\r\n    <div class=\"stock-selector\">\r\n      <div class=\"selector-description\">\r\n        <span class=\"description-text\">添加股票进行相似度分析，第一只股票为基准股票</span>\r\n      </div>\r\n      <div class=\"selector-controls\">\r\n        <el-select\r\n          v-model=\"newMarketId\"\r\n          placeholder=\"选择市场\"\r\n          style=\"width: 120px; margin-right: 10px\"\r\n        >\r\n          <el-option \r\n            v-for=\"(name, id) in marketMap\" \r\n            :key=\"id\"\r\n            :label=\"name\" \r\n            :value=\"id\" \r\n          />\r\n        </el-select>\r\n        <el-input\r\n          v-model=\"newStockCode\"\r\n          placeholder=\"请输入股票代码\"\r\n          style=\"width: 200px; margin-right: 10px\"\r\n          @keyup.enter=\"addStock\"\r\n          :loading=\"isSearching\"\r\n        >\r\n          <template #prefix>\r\n            <el-icon v-if=\"isSearching\" class=\"is-loading\"><Loading /></el-icon>\r\n          </template>\r\n        </el-input>\r\n        <el-input\r\n          v-model=\"newStockName\"\r\n          placeholder=\"请输入股票名称\"\r\n          style=\"width: 200px; margin-right: 10px\"\r\n          @keyup.enter=\"addStock\"\r\n        />\r\n        <el-button type=\"primary\" @click=\"addStock\">添加到分析</el-button>\r\n      </div>\r\n    </div>\r\n\r\n\r\n    <!-- 图表容器 -->\r\n    <div class=\"chart-container\">\r\n      <IntradayChart \r\n        :stock-data=\"stockList\"\r\n        :loading=\"isLoading\"\r\n        height=\"500px\"\r\n        @chartUpdate=\"onChartUpdate\"\r\n        ref=\"intradayChartRef\"\r\n      />\r\n      <div v-if=\"isLoading\" class=\"loading-overlay\">\r\n        <el-loading-spinner />\r\n        <span>正在加载分时数据...</span>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 股票列表 -->\r\n    <div class=\"stock-list\">\r\n      <h3>相似度分析结果</h3>\r\n      <el-table :data=\"stockList\" style=\"width: 100%\">\r\n        <el-table-column prop=\"code\" label=\"股票代码\" width=\"120\" />\r\n        <el-table-column prop=\"name\" label=\"股票名称\" width=\"150\" />\r\n        <el-table-column prop=\"price\" label=\"当前价格\" width=\"100\" />\r\n        <el-table-column prop=\"change\" label=\"涨跌幅\" width=\"100\">\r\n          <template #default=\"scope\">\r\n            <span :class=\"getChangeClass(scope.row.change)\">\r\n              {{ scope.row.change > 0 ? '+' : '' }}{{ scope.row.change }}%\r\n            </span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"与基准股相似度\" width=\"140\">\r\n          <template #default=\"scope\">\r\n            <div style=\"display: flex; align-items: center; gap: 8px;\">\r\n              <el-progress \r\n                v-if=\"scope.$index !== 0\"\r\n                :percentage=\"calculateSimilarityData(scope.row, scope.$index).similarity\"\r\n                :color=\"calculateSimilarityData(scope.row, scope.$index).color\"\r\n                :stroke-width=\"6\"\r\n                :show-text=\"false\"\r\n                style=\"width: 60px;\"\r\n              />\r\n              <span :style=\"{ color: calculateSimilarityData(scope.row, scope.$index).color, fontSize: '12px', fontWeight: 'bold' }\">\r\n                {{ scope.$index === 0 ? '--' : calculateSimilarityData(scope.row, scope.$index).similarity + '%' }}\r\n              </span>\r\n            </div>\r\n            <div style=\"font-size: 11px; color: #666; margin-top: 2px;\">\r\n              {{ scope.$index === 0 ? '' : calculateSimilarityData(scope.row, scope.$index).label }}\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"昨日相似度对比\" width=\"140\">\r\n          <template #default=\"scope\">\r\n            <div style=\"display: flex; align-items: center; gap: 8px;\">\r\n              <el-progress \r\n                v-if=\"scope.$index !== 0\"\r\n                :percentage=\"calculateSimilarityData(scope.row, scope.$index).prevSimilarity || 0\"\r\n                :color=\"calculateSimilarityData(scope.row, scope.$index).prevColor || '#909399'\"\r\n                :stroke-width=\"6\"\r\n                :show-text=\"false\"\r\n                style=\"width: 60px;\"\r\n              />\r\n              <span :style=\"{ color: calculateSimilarityData(scope.row, scope.$index).prevColor || '#909399', fontSize: '12px', fontWeight: 'bold' }\">\r\n                {{ scope.$index === 0 ? '--' : (calculateSimilarityData(scope.row, scope.$index).prevSimilarity || 0) + '%' }}\r\n              </span>\r\n            </div>\r\n            <div style=\"font-size: 11px; color: #666; margin-top: 2px;\">\r\n              {{ scope.$index === 0 ? '' : calculateSimilarityData(scope.row, scope.$index).prevLabel }}\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" width=\"100\">\r\n          <template #default=\"scope\">\r\n            <el-button\r\n              type=\"danger\"\r\n              size=\"small\"\r\n              @click=\"removeStock(scope.$index)\"\r\n            >\r\n              删除\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted, watch } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport { Refresh, Loading } from '@element-plus/icons-vue'\r\nimport { fetchMinuteData, getLatestTradeDate, isTradeTime, getPreTradeDate, getPreviousTradeDates } from '../utils/quoteApi'\r\nimport IntradayChart from '../components/IntradayChart.vue'\r\nimport { analyzeSellPoints } from '../strategies/sellPointAnalysis'\r\nimport { getLimitPrices } from '../utils/common'\r\nimport { calculateStockSimilarity } from '../strategies/pearsonCorrelation'\r\n// ==================== 响应式数据 ====================\r\nconst intradayChartRef = ref(null)\r\nconst stockList = ref([]) // 股票列表\r\nconst isLoading = ref(false) // 加载状态\r\nconst currentDate = ref('') // 当前选择的日期\r\nconst refreshTimer = ref(null) // 定时刷新定时器\r\nconst isTradingTime = ref(false) // 是否在交易时间内\r\nconst mainStockSummary = ref(null)\r\n\r\n// 新增股票的表单数据\r\nconst newMarketId = ref('17') // 默认选择沪市A股\r\nconst newStockCode = ref('') // 股票代码输入\r\nconst newStockName = ref('') // 股票名称输入\r\nconst isSearching = ref(false) // 搜索状态\r\n\r\n// ==================== 常量定义 ====================\r\nconst STORAGE_KEY = 'multiStockChart_stockList' // localStorage 存储键\r\n\r\n// 市场ID映射表\r\nconst marketMap = {\r\n  '17': '沪市A股',\r\n  '33': '深市A股', \r\n  '48': '概念',\r\n  '177': '港股',\r\n  '20': '港股基金'\r\n}\r\n\r\n// ==================== 股票管理功能 ====================\r\n\r\n/**\r\n * 搜索股票信息\r\n */\r\nconst searchStock = async (keyword) => {\r\n  if (!keyword || keyword.length !== 6) return\r\n  \r\n  isSearching.value = true\r\n  try {\r\n    const response = await fetch(`https://www.wttiao.com/moni/quote/search?keyword=${keyword}`)\r\n    const result = await response.json()\r\n    console.log(\"searchStock result:\", result)\r\n    if (result.code === 0 && result.data && result.data.length > 0) {\r\n      const stock = result.data[0]\r\n      // 填充股票名称\r\n      newStockName.value = stock.name || ''\r\n      \r\n      // 使用接口返回的marketId\r\n      if (stock.marketId && marketMap[stock.marketId]) {\r\n        newMarketId.value = stock.marketId.toString()\r\n      } else {\r\n        // 如果接口没有返回marketId，则根据股票代码前缀设置市场\r\n        if (keyword.startsWith('6')) {\r\n          newMarketId.value = '17' // 沪市A股\r\n        } else if (keyword.startsWith('0') || keyword.startsWith('3')) {\r\n          newMarketId.value = '33' // 深市A股\r\n        }\r\n      }\r\n      \r\n      ElMessage.success(`找到股票: ${stock.name}(${keyword})`)\r\n    } else {\r\n      ElMessage.warning('未找到该股票信息')\r\n    }\r\n  } catch (error) {\r\n    console.error('搜索股票失败:', error)\r\n    ElMessage.error('搜索股票失败')\r\n  } finally {\r\n    isSearching.value = false\r\n  }\r\n}\r\n\r\n/**\r\n * 添加股票到监控列表\r\n */\r\nconst addStock = async () => {\r\n  // 验证输入\r\n  if (!newStockCode.value || !newMarketId.value) {\r\n    ElMessage.warning('请选择市场并输入股票代码')\r\n    return\r\n  }\r\n  \r\n  const marketId = newMarketId.value\r\n  const code = newStockCode.value.toUpperCase()\r\n  \r\n  // 检查是否已存在\r\n  if (stockList.value.find(stock => stock.marketId === marketId && stock.code === code)) {\r\n    ElMessage.warning('该股票已添加')\r\n    return\r\n  }\r\n\r\n  // 创建新股票对象\r\n  const userStockName = newStockName.value.trim()\r\n  const finalStockName = userStockName || code\r\n  \r\n  const newStock = {\r\n    marketId,\r\n    marketName: marketMap[marketId],\r\n    code,\r\n    name: finalStockName,\r\n    price: '0.00',\r\n    change: '0.00',\r\n    preClose: null, // 昨收价，将从API数据中获取\r\n    minuteData: [] // 分时数据\r\n  }\r\n  \r\n  // 添加到列表并保存\r\n  stockList.value.push(newStock)\r\n  newStockCode.value = ''\r\n  newStockName.value = ''\r\n  saveToLocalStorage()\r\n  \r\n  // 如果有日期，立即获取分时数据\r\n  if (currentDate.value) {\r\n    await fetchMinuteDataFromApi()\r\n  }\r\n}\r\n\r\n/**\r\n * 从监控列表中移除股票\r\n * @param {number} index 股票在列表中的索引\r\n */\r\nconst removeStock = (index) => {\r\n  stockList.value.splice(index, 1)\r\n  saveToLocalStorage()\r\n}\r\n\r\n// ==================== 数据持久化 ====================\r\n\r\n/**\r\n * 保存股票列表到 localStorage\r\n */\r\nconst saveToLocalStorage = () => {\r\n  try {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(stockList.value))\r\n  } catch (error) {\r\n    console.error('保存到 localStorage 失败:', error)\r\n    ElMessage.error('保存数据失败')\r\n  }\r\n}\r\n\r\n/**\r\n * 从 localStorage 加载股票列表\r\n */\r\nconst loadFromLocalStorage = () => {\r\n  try {\r\n    const savedData = localStorage.getItem(STORAGE_KEY)\r\n    if (savedData) {\r\n      stockList.value = JSON.parse(savedData)\r\n    }\r\n  } catch (error) {\r\n    console.error('从 localStorage 加载数据失败:', error)\r\n    ElMessage.error('加载保存的数据失败')\r\n  }\r\n}\r\n\r\n// ==================== 交易时间管理 ====================\r\n\r\n/**\r\n * 检查是否在交易时间内\r\n * @returns {Promise<boolean>} 是否在交易时间\r\n */\r\nconst checkTradingTime = async () => {\r\n  if (stockList.value.length === 0) {\r\n    return false\r\n  }\r\n  \r\n  try {\r\n    // 使用第一只股票的代码检查交易时间\r\n    const firstStock = stockList.value[0]\r\n    const stockCode = `${firstStock.marketId}:${firstStock.code}`\r\n    const result = await isTradeTime(firstStock.code)\r\n    \r\n    // API 返回 0 为非交易时间，非 0 为交易时间\r\n    return result !== 0\r\n  } catch (error) {\r\n    console.error('检查交易时间失败:', error)\r\n    return false\r\n  }\r\n}\r\n\r\n// ==================== 定时刷新功能 ====================\r\n\r\n/**\r\n * 启动定时刷新\r\n */\r\nconst startAutoRefresh = () => {\r\n  if (refreshTimer.value) {\r\n    clearInterval(refreshTimer.value)\r\n  }\r\n  \r\n  refreshTimer.value = setInterval(async () => {\r\n    const tradingTime = await checkTradingTime()\r\n    isTradingTime.value = tradingTime\r\n    \r\n    if (tradingTime && stockList.value.length > 0) {\r\n      try {\r\n        await refreshMinuteDataOnly()\r\n        console.log('定时刷新完成')\r\n      } catch (error) {\r\n        console.error('定时刷新数据失败:', error)\r\n      }\r\n    }\r\n  }, 1000) // 每秒检查一次\r\n}\r\n\r\n/**\r\n * 停止定时刷新\r\n */\r\nconst stopAutoRefresh = () => {\r\n  if (refreshTimer.value) {\r\n    clearInterval(refreshTimer.value)\r\n    refreshTimer.value = null\r\n  }\r\n}\r\n\r\n// ==================== 数据获取和处理 ====================\r\n\r\n/**\r\n * 获取前一个交易日日期\r\n * @param {string} dateStr 当前日期字符串 (YYYYMMDD)\r\n * @returns {Promise<string>} 前一个交易日日期字符串的Promise\r\n */\r\nconst getPreviousTradeDate = async (dateStr) => {\r\n  // 处理dateStr可能为空的情况\r\n  const targetDate = dateStr || new Date().toISOString().slice(0, 10).replace(/-/g, '');\r\n  \r\n  // 使用quoteApi.js的getPreTradeDate获取目标日期的前一个交易日\r\n  const previousTradeDate = await getPreTradeDate(targetDate);\r\n  return previousTradeDate;\r\n}\r\n\r\n/**\r\n * 处理API返回的分时数据，转换为应用所需格式\r\n * @param {Object} apiData API返回的原始数据\r\n * @param {Object} yesterdayData 昨日API返回的原始数据\r\n * @param {Array} currentStockList 当前股票列表\r\n * @returns {Object} 处理结果 { updatedStockList, hasUpdates }\r\n */\r\nconst processMinuteData = (apiData, yesterdayData, currentStockList) => {\r\n  if (!currentStockList || !Array.isArray(currentStockList)) {\r\n    return { updatedStockList: [], hasUpdates: false }\r\n  }\r\n  const updatedStockList = [...currentStockList]\r\n  let hasUpdates = false\r\n  \r\n  updatedStockList.forEach((stock, index) => {\r\n    const stockKey = `${stock.marketId}:${stock.code}`\r\n    const stockData = apiData[stockKey]\r\n    const yesterdayStockData = yesterdayData ? yesterdayData[stockKey] : null\r\n    \r\n    if (stockData) {\r\n      // 转换当日数据格式\r\n      const chartData = Object.entries(stockData).map(([timeStr, values]) => {\r\n        return [timeStr, values.changePercent]\r\n      })\r\n      \r\n      // 转换昨日数据格式\r\n      let prevChartData = []\r\n      if (yesterdayStockData) {\r\n        prevChartData = Object.entries(yesterdayStockData).map(([timeStr, values]) => {\r\n          return [timeStr, values.changePercent]\r\n        })\r\n      }\r\n      \r\n      // 保存当日原始数据\r\n      const rawData = {}\r\n      Object.entries(stockData).forEach(([timeStr, values]) => {\r\n        rawData[timeStr] = {\r\n          NEW: values.NEW,\r\n          JUNJIA: values.JUNJIA,\r\n          VOL: parseFloat(values.VOL || 0),\r\n          money: values.money,\r\n          changePercent: values.changePercent,\r\n          preClose: values.preClose\r\n        }\r\n      })\r\n      \r\n      // 保存昨日原始数据\r\n      const prevRawData = {}\r\n      if (yesterdayStockData) {\r\n        Object.entries(yesterdayStockData).forEach(([timeStr, values]) => {\r\n          prevRawData[timeStr] = {\r\n            NEW: values.NEW,\r\n            JUNJIA: values.JUNJIA,\r\n            VOL: parseFloat(values.VOL || 0),\r\n            money: values.money,\r\n            changePercent: values.changePercent,\r\n            preClose: values.preClose\r\n          }\r\n        })\r\n      }\r\n      \r\n      // 从第一个时间点的数据中获取昨收价\r\n      const firstTimeData = Object.values(stockData)[0]\r\n      const preClose = firstTimeData?.preClose || null\r\n      \r\n      // 更新股票对象 - 只在有昨日数据时才更新prevChangePercent，否则保留原有数据\r\n      const prevChangePercentData = prevChartData.length > 0 ? \r\n        prevChartData.map(item => item[1]) : \r\n        (stock.prevChangePercent || [])\r\n      \r\n      updatedStockList[index] = {\r\n        ...stock,\r\n        minuteData: chartData,\r\n        rawData: rawData,\r\n        preClose: preClose,\r\n        changePercent: chartData.map(item => item[1]),\r\n        prevChangePercent: prevChangePercentData\r\n      }\r\n      \r\n      // 更新最新价格和涨跌幅\r\n      if (chartData.length > 0) {\r\n        const latestTimeData = Object.values(stockData).pop()\r\n        const latestPrice = parseFloat(latestTimeData?.NEW || latestTimeData?.JUNJIA || 0)\r\n        const latestChange = chartData[chartData.length - 1][1]\r\n        \r\n        updatedStockList[index].price = latestPrice.toFixed(3)\r\n        updatedStockList[index].change = latestChange.toFixed(2)\r\n      }\r\n      \r\n      hasUpdates = true\r\n    }\r\n  })\r\n  \r\n  return { updatedStockList, hasUpdates }\r\n}\r\n\r\n/**\r\n * 仅刷新分时数据（用于定时刷新）\r\n */\r\nconst refreshMinuteDataOnly = async () => {\r\n  if (stockList.value.length === 0 || !currentDate.value) return\r\n  \r\n  try {\r\n    console.log('开始定时刷新分时数据...')\r\n    const stockCodes = stockList.value.map(stock => `${stock.marketId}:${stock.code}`)\r\n    const data = await fetchMinuteData(stockCodes, currentDate.value)\r\n    \r\n    if (data) {\r\n      const { updatedStockList, hasUpdates } = processMinuteData(data, null, stockList.value)\r\n      \r\n      // 只有在有更新时才触发响应式更新\r\n      if (hasUpdates) {\r\n        stockList.value.splice(0, stockList.value.length, ...updatedStockList)\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.error('刷新分时数据失败:', error)\r\n  }\r\n}\r\n\r\n/**\r\n * 获取分时数据（完整流程）\r\n */\r\nconst fetchMinuteDataFromApi = async () => {\r\n  if (stockList.value.length === 0 || !currentDate.value) return\r\n  \r\n  try {\r\n    isLoading.value = true\r\n    \r\n    const stockCodes = stockList.value.map(stock => `${stock.marketId}:${stock.code}`)\r\n    \r\n    // 获取当日数据\r\n    const todayData = await fetchMinuteData(stockCodes, currentDate.value)\r\n    \r\n    // 获取昨日数据\r\n    const yesterdayDate = await getPreviousTradeDate(currentDate.value)\r\n    console.log('yesterdayDate:', yesterdayDate, currentDate.value);\r\n    let yesterdayData = null\r\n    \r\n    try {\r\n      yesterdayData = await fetchMinuteData(stockCodes, yesterdayDate)\r\n      console.log('昨日数据获取成功:', yesterdayDate)\r\n    } catch (yesterdayError) {\r\n      console.warn('昨日数据获取失败，使用空数据:', yesterdayError.message)\r\n      yesterdayData = {}\r\n    }\r\n    \r\n    if (todayData) {\r\n      const mainStock = stockList.value[0]\r\n      const mainStockData = todayData[`${mainStock.marketId}:${mainStock.code}`]\r\n      \r\n      // 获取涨跌停价\r\n      const { limitUpPrice, limitDownPrice } = getLimitPrices(mainStock.code, mainStock.preClose)\r\n      mainStock.limitUpPrice = limitUpPrice\r\n      mainStock.limitDownPrice = limitDownPrice\r\n      \r\n      // 获取卖点\r\n      const { sellPoints, summary } = analyzeSellPoints(mainStockData, mainStock)\r\n      mainStockSummary.value = summary\r\n      \r\n      // 处理并合并数据\r\n      const { updatedStockList } = processMinuteData(todayData, yesterdayData, stockList.value)\r\n      \r\n      // 将卖点数据添加到主股票中\r\n      if (updatedStockList.length > 0 && sellPoints.length > 0) {\r\n        updatedStockList[0].sellPoints = sellPoints\r\n      }\r\n      \r\n      // 触发响应式更新\r\n      stockList.value.splice(0, stockList.value.length, ...updatedStockList)\r\n    }\r\n  } catch (error) {\r\n    console.error('获取分时数据失败:', error)\r\n    ElMessage.error('获取分时数据失败')\r\n  } finally {\r\n    isLoading.value = false\r\n  }\r\n}\r\n\r\n\r\n\r\n// ==================== 事件处理 ====================\r\n\r\n/**\r\n * 日期变化处理\r\n * @param {string} newDate 新选择的日期\r\n */\r\nconst onDateChange = async (newDate) => {\r\n  if (newDate && stockList.value.length > 0) {\r\n    console.log('日期已更改为:', newDate)\r\n    await fetchMinuteDataFromApi()\r\n  }\r\n}\r\n\r\n/**\r\n * 手动刷新数据\r\n */\r\nconst refreshData = async () => {\r\n  if (stockList.value.length === 0) {\r\n    ElMessage.warning('没有股票数据可刷新')\r\n    return\r\n  }\r\n  \r\n  if (!currentDate.value) {\r\n    ElMessage.warning('请先选择日期')\r\n    return\r\n  }\r\n  \r\n  // 清空现有数据\r\n  const updatedStockList = stockList.value.map(stock => ({\r\n    ...stock,\r\n    minuteData: [],\r\n    rawData: {}\r\n  }))\r\n  \r\n  stockList.value.splice(0, stockList.value.length, ...updatedStockList)\r\n  \r\n  await fetchMinuteDataFromApi()\r\n  ElMessage.success('数据刷新成功')\r\n}\r\n\r\n\r\n/**\r\n * 图表更新回调\r\n * @param {Object} data 图表数据\r\n */\r\nconst onChartUpdate = (data) => {\r\n  console.log('图表已更新:', data)\r\n}\r\n\r\n/**\r\n * 获取涨跌幅样式类名\r\n * @param {string|number} change 涨跌幅\r\n * @returns {string} CSS类名\r\n */\r\nconst getChangeClass = (change) => {\r\n  const num = Number(change)\r\n  if (num > 0) return 'positive-red'\r\n  if (num < 0) return 'negative-green'\r\n  return ''\r\n}\r\n\r\n/**\r\n * 计算股票相似度数据\r\n * @param {Object} stock 当前股票\r\n * @param {number} index 股票索引\r\n * @returns {Object} 相似度数据\r\n */\r\nconst calculateSimilarityData = (stock, index) => {\r\n  if (index === 0 || stockList.value.length === 0) {\r\n    return {\r\n      similarity: 0,\r\n      label: '--',\r\n      level: 'none',\r\n      color: '#909399',\r\n      prevSimilarity: null,\r\n      prevLabel: null,\r\n      prevColor: '#909399'\r\n    }\r\n  }\r\n  \r\n  const mainStock = stockList.value[0]\r\n  \r\n  if (!mainStock || !stock) {\r\n    return {\r\n      similarity: 0,\r\n      label: '无数据',\r\n      level: 'none',\r\n      color: '#909399',\r\n      prevSimilarity: null,\r\n      prevLabel: null,\r\n      prevColor: '#909399'\r\n    }\r\n  }\r\n  \r\n  // 获取股票的涨跌幅数据\r\n  const getStockChangeData = (stock, isPrevious = false) => {\r\n    const dataKey = isPrevious ? 'prevChangePercent' : 'changePercent'\r\n    \r\n    if (stock[dataKey] && stock[dataKey].length > 0) {\r\n      return stock[dataKey]\r\n    }\r\n    \r\n    if (stock.rawData) {\r\n      // 从rawData中提取涨跌幅数据\r\n      const timeKeys = Object.keys(stock.rawData).sort()\r\n      const changes = timeKeys.map(time => stock.rawData[time].changePercent || 0)\r\n      return changes\r\n    }\r\n    \r\n    if (stock.minuteData && stock.minuteData.length > 0) {\r\n      // 从minuteData中提取涨跌幅数据\r\n      return stock.minuteData.map(item => item[1] || 0)\r\n    }\r\n    \r\n    return []\r\n  }\r\n  \r\n  // 计算当日相似度\r\n  const mainData = getStockChangeData(mainStock)\r\n  const stockData = getStockChangeData(stock)\r\n  \r\n  // 计算上一日相似度\r\n  const prevMainData = getStockChangeData(mainStock, true)\r\n  const prevStockData = getStockChangeData(stock, true)\r\n  \r\n  const getColorByLevel = (level) => {\r\n    switch (level) {\r\n      case 'extremely-strong':\r\n      case 'strong':\r\n        return '#f56c6c'\r\n      case 'moderate':\r\n        return '#e6a23c'\r\n      case 'weak':\r\n        return '#409eff'\r\n      case 'very-weak':\r\n      case 'none':\r\n        return '#909399'\r\n      default:\r\n        return '#909399'\r\n    }\r\n  }\r\n  \r\n  try {\r\n    // 计算当日相似度\r\n    let similarity = 0\r\n    let label = '无数据'\r\n    let level = 'none'\r\n    \r\n    if (mainData.length > 0 && stockData.length > 0) {\r\n      const tempMainStock = { changePercent: mainData }\r\n      const tempStock = { changePercent: stockData }\r\n      const result = calculateStockSimilarity(tempMainStock, tempStock, 'changePercent')\r\n      similarity = result.similarity\r\n      label = result.label\r\n      level = result.level\r\n    }\r\n    \r\n    // 计算上一日相似度\r\n    let prevSimilarity = null\r\n    let prevLabel = null\r\n    let prevLevel = 'none'\r\n    \r\n    if (prevMainData.length > 0 && prevStockData.length > 0) {\r\n      const prevTempMainStock = { changePercent: prevMainData }\r\n      const prevTempStock = { changePercent: prevStockData }\r\n      const prevResult = calculateStockSimilarity(prevTempMainStock, prevTempStock, 'changePercent')\r\n      prevSimilarity = prevResult.similarity\r\n      prevLabel = prevResult.label\r\n      prevLevel = prevResult.level\r\n    }\r\n    \r\n    return {\r\n      similarity,\r\n      label,\r\n      level,\r\n      color: getColorByLevel(level),\r\n      prevSimilarity,\r\n      prevLabel,\r\n      prevLevel,\r\n      prevColor: getColorByLevel(prevLevel)\r\n    }\r\n  } catch (error) {\r\n    console.error('计算相似度失败:', error)\r\n    return {\r\n      similarity: 0,\r\n      label: '计算错误',\r\n      level: 'error',\r\n      color: '#909399',\r\n      prevSimilarity: null,\r\n      prevLabel: null,\r\n      prevColor: '#909399'\r\n    }\r\n  }\r\n}\r\n\r\n// ==================== 生命周期钩子 ====================\r\n\r\nonMounted(async () => {\r\n  try {\r\n    // 获取最近交易日并设置为当前日期\r\n    const latestTradeDate = await getLatestTradeDate()\r\n    currentDate.value = latestTradeDate\r\n    console.log('初始化日期为最近交易日:', latestTradeDate)\r\n  } catch (error) {\r\n    console.error('获取最近交易日失败，使用当前日期:', error)\r\n    currentDate.value = new Date().toISOString().slice(0, 10).replace(/-/g, '')\r\n  }\r\n  \r\n  // 加载保存的数据\r\n  loadFromLocalStorage()\r\n  \r\n  // 如果有日期和股票数据，获取分时数据\r\n  if (currentDate.value && stockList.value.length > 0) {\r\n    await fetchMinuteDataFromApi()\r\n  }\r\n  \r\n  // 启动定时刷新\r\n  startAutoRefresh()\r\n})\r\n\r\nonUnmounted(() => {\r\n  stopAutoRefresh()\r\n})\r\n\r\n// ==================== 监听器 ====================\r\n\r\nwatch(newStockCode, (newCode) => {\r\n  // 监听股票代码输入，当输入6位数字时自动搜索\r\n  if (newCode && newCode.length === 6 && /^\\d{6}$/.test(newCode)) {\r\n    searchStock(newCode)\r\n  }\r\n})\r\n\r\nwatch(stockList, (newVal, oldVal) => {\r\n  console.log('stockList 发生变化:', {\r\n    newLength: newVal.length,\r\n    oldLength: oldVal?.length,\r\n    hasMinuteData: newVal.some(stock => stock.minuteData && stock.minuteData.length > 0)\r\n  })\r\n}, { deep: true })\r\n</script>\r\n\r\n<style scoped>\r\n.multi-stock-chart {\r\n  padding: 20px;\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.header h2 {\r\n  margin: 0;\r\n  color: #333;\r\n}\r\n\r\n.stock-selector {\r\n  margin-bottom: 20px;\r\n  padding: 16px;\r\n  background: #f8f9fa;\r\n  border-radius: 8px;\r\n  border: 1px solid #e9ecef;\r\n}\r\n\r\n.selector-description {\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.description-text {\r\n  color: #666;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n}\r\n\r\n.selector-controls {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.chart-container {\r\n  flex: 1;\r\n  margin-bottom: 20px;\r\n  position: relative;\r\n}\r\n\r\n.stock-list {\r\n  flex-shrink: 0;\r\n}\r\n\r\n.stock-list h3 {\r\n  margin-bottom: 10px;\r\n  color: #333;\r\n}\r\n\r\n/* 涨跌幅样式 */\r\n.positive-red {\r\n  color: #f56c6c;\r\n}\r\n\r\n.negative-green {\r\n  color: #67c23a;\r\n}\r\n\r\n.loading-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(255, 255, 255, 0.8);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  z-index: 10;\r\n}\r\n</style>"],"names":["props","__props","emit","__emit","chartRef","ref","chart","timeAxis","pad","n","times","h","m","STOCK_COLOR_POOL","processStockData","stock","preClose","prices","volumes","avgPrice","change","changePercent","junjia","time","rawItem","newPrice","junjiaPrice","volume","pct","dataMap","item","index","changePct","pctValue","price","processMultiStockData","mainStock","otherStocks","i","processedData","calculatePriceRange","changeRange","p","calculateMultiStockChangeRange","allChanges","c","stockData","maxChange","minChange","maxAbsChange","changePadding","finalMaxChange","generateStockColors","count","result","generateSellMarkPoint","markPointData","sellPoint","timeIndex","symbol","symbolRotate","color","label","generateBuyMarkPoint","buyPoint","updateProfessionalChart","_a","multiStockData","priceRange","validVolumes","v","maxVolume","volumeRange","markLine","generateCombinedMarkPoint","sellMarks","buyMarks","combinedData","getLegendLabel","key","series","stockColors","mainLegendLabel","params","currentPrice","previousPrice","option","s","value","updateChart","resizeChart","onMounted","echarts.init","onUnmounted","watch","newVal","oldVal","__expose","_openBlock","_createElementBlock","_hoisted_1","_hoisted_2","_createVNode","_component_el_loading_spinner","_cache","_createElementVNode","analyzeSellPoints","stockInfo","conceptPeersData","sellPoints","summary","dataArray","timestamp","data","limitUpPrice","limitDownPrice","stagnationSellPoint","detectStagnation","maxPrice","maxPriceIndex","currentTimestamp","currentData","SELL_POINT_META","point","firstPullbackIndex","minPrice","minIndex","baseVolume","lastHourData","lastHourPrices","lastHourVolumes","avgLastHourPrice","a","b","avgLastHourVolume","currentVolume","originalIndex","prevPrice","vol5","calcMA","prevTimestamp","prevData","arr","idx","period","sum","group5min","group","stats5min","t","vols","moneys","avg5minVol","isLate","priceCond","_b","prevVol","volThreshold","volCond","avgAmtCond","conceptCond","peerCount","peer","peerTimes","peerGroup5min","j","high","low","amp","avg5minVolPeer","g","getLimitPrices","code","limitPercent","calculatePearsonCorrelation","data1","data2","validPairs","sumX","pair","sumY","meanX","meanY","numerator","sumSquareX","sumSquareY","xi","yi","devX","devY","denominator","getCorrelationLabel","correlation","absCorrelation","level","normalizeChangePercent","limitUpPercent","limit","percent","calculateStockSimilarity","stock1","stock2","dataType","normalize","includePrevious","prevData1","prevData2","limit1","limit2","prevCorrelation","prevSimilarity","prevLabel","prevCorr","prevResult","prevError","validDataPoints","val","error","STORAGE_KEY","intradayChartRef","stockList","isLoading","currentDate","refreshTimer","isTradingTime","mainStockSummary","newMarketId","newStockCode","newStockName","isSearching","marketMap","searchStock","keyword","ElMessage","addStock","marketId","finalStockName","newStock","saveToLocalStorage","fetchMinuteDataFromApi","removeStock","loadFromLocalStorage","savedData","checkTradingTime","firstStock","stockCode","isTradeTime","startAutoRefresh","tradingTime","refreshMinuteDataOnly","stopAutoRefresh","getPreviousTradeDate","dateStr","targetDate","getPreTradeDate","processMinuteData","apiData","yesterdayData","currentStockList","updatedStockList","hasUpdates","stockKey","yesterdayStockData","chartData","timeStr","values","prevChartData","rawData","firstTimeData","prevChangePercentData","latestTimeData","latestPrice","latestChange","stockCodes","fetchMinuteData","todayData","yesterdayDate","yesterdayError","mainStockData","onDateChange","newDate","refreshData","onChartUpdate","getChangeClass","num","calculateSimilarityData","getStockChangeData","isPrevious","dataKey","mainData","prevMainData","prevStockData","getColorByLevel","similarity","prevLevel","latestTradeDate","getLatestTradeDate","newCode","_hoisted_3","_component_el_date_picker","$event","_component_el_button","_component_el_icon","_unref","Refresh","_hoisted_4","_hoisted_5","_component_el_select","_Fragment","_renderList","name","id","_component_el_option","_component_el_input","_createBlock","Loading","_hoisted_6","IntradayChart","_hoisted_7","_hoisted_8","_component_el_table","_component_el_table_column","_withCtx","scope","_toDisplayString","_hoisted_9","_component_el_progress","_normalizeStyle","_hoisted_10","_hoisted_11","_hoisted_12"],"mappings":"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"}