{"version":3,"file":"concept-08ac21f6.js","sources":["../../front/src/api/concept.js"],"sourcesContent":["import axios from 'axios';\r\nimport { getStocksByConceptCode as getStocksByConceptCodeFromQuote } from '../utils/quoteApi';\r\n\r\n// 根据概念代码获取股票列表\r\nexport const getStocksByConceptCode = async (conceptCode) => {\r\n  try {\r\n    return await getStocksByConceptCodeFromQuote(conceptCode);\r\n  } catch (error) {\r\n    console.error('获取概念股票失败:', error);\r\n    throw new Error(`获取概念 ${conceptCode} 的股票失败: ${error.message}`);\r\n  }\r\n};\r\n\r\n// 保存概念股票关系\r\nexport const saveConceptStockRelations = async (relations) => {\r\n  try {\r\n    const response = await axios.post(\r\n      'https://www.wttiao.com/moni/concepts/relations',\r\n      {\r\n        relations: relations,\r\n      },\r\n      {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n      }\r\n    );\r\n\r\n    if (response.status === 200) {\r\n      return response.data;\r\n    }\r\n    throw new Error('保存失败');\r\n  } catch (error) {\r\n    console.error('保存概念股票关系失败:', error);\r\n    throw new Error(`保存概念股票关系失败: ${error.message}`);\r\n  }\r\n};\r\n\r\n// 获取概念列表\r\nexport const getConceptList = async (onlyCodes = false) => {\r\n  try {\r\n    const response = await axios.get(\r\n      'https://www.wttiao.com/moni/concepts/list/',\r\n      {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n      }\r\n    );\r\n\r\n    if (response.data.code === 0 && response.data.data) {\r\n      if (onlyCodes) {\r\n        // 只返回概念代码数组\r\n        const conceptCodes = response.data.data.map((concept) => concept.code);\r\n        console.log(`成功获取 ${conceptCodes.length} 个概念代码`);\r\n        return conceptCodes;\r\n      } else {\r\n        // 返回完整的概念信息\r\n        return response.data.data;\r\n      }\r\n    } else {\r\n      throw new Error(response.data.msg || '获取概念列表失败');\r\n    }\r\n  } catch (error) {\r\n    console.error('获取概念列表失败:', error);\r\n    throw new Error(`获取概念列表失败: ${error.message}`);\r\n  }\r\n};\r\n\r\n// 获取所有概念代码列表（用于全量更新）- 保持向后兼容\r\nexport const getAllConceptCodes = async () => {\r\n  return await getConceptList(true);\r\n};\r\n\r\n// 获取概念排行数据（涨幅前十和跌幅前十）\r\nexport const getConceptRanking = async () => {\r\n  try {\r\n    const response = await axios.get(\r\n      'https://zx.10jqka.com.cn/hotblock/proxy/block/platerankinfo',\r\n      {\r\n        params: {\r\n          platetype: 'all',\r\n          'client-type': 0,\r\n        },\r\n        timeout: 10000,\r\n      }\r\n    );\r\n\r\n    if (\r\n      response.data &&\r\n      response.data.errorcode === 0 &&\r\n      response.data.result\r\n    ) {\r\n      const data = response.data.result;\r\n\r\n      // 根据increase字段排序并提取前十\r\n      const sortedData = [...data].sort((a, b) => b.increase - a.increase);\r\n\r\n      // 提取涨幅前十\r\n      const topRisers = sortedData.slice(0, 10).map((item) => ({\r\n        name: item.platename,\r\n        code: item.platecode.toString(),\r\n        changePercent: parseFloat(item.increase || 0).toFixed(2),\r\n      }));\r\n\r\n      // 提取跌幅前十（按涨幅排序后取最后10个并反转）\r\n      const topFallers = sortedData\r\n        .slice(-10)\r\n        .reverse()\r\n        .map((item) => ({\r\n          name: item.platename,\r\n          code: item.platecode.toString(),\r\n          changePercent: parseFloat(item.increase || 0).toFixed(2),\r\n        }));\r\n\r\n      return {\r\n        topRisers,\r\n        topFallers,\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    } else {\r\n      console.warn('获取概念排行数据失败，返回空数据');\r\n      return {\r\n        topRisers: [],\r\n        topFallers: [],\r\n        timestamp: new Date().toISOString(),\r\n      };\r\n    }\r\n  } catch (error) {\r\n    console.error('获取概念排行数据失败:', error);\r\n    // 返回空数据而不是抛出错误，避免影响用户体验\r\n    return {\r\n      topRisers: [],\r\n      topFallers: [],\r\n      timestamp: new Date().toISOString(),\r\n      error: error.message,\r\n    };\r\n  }\r\n};\r\n"],"names":["getStocksByConceptCode","conceptCode","getStocksByConceptCodeFromQuote","error","saveConceptStockRelations","relations","response","axios","getConceptList","onlyCodes","conceptCodes","concept","getConceptRanking","sortedData","b","topRisers","item","topFallers"],"mappings":"mFAIY,MAACA,EAAyB,MAAOC,GAAgB,CAC3D,GAAI,CACF,OAAO,MAAMC,EAAgCD,CAAW,CACzD,OAAQE,EAAO,CACd,cAAQ,MAAM,YAAaA,CAAK,EAC1B,IAAI,MAAM,QAAQF,CAAW,WAAWE,EAAM,OAAO,EAAE,CAC9D,CACH,EAGaC,EAA4B,MAAOC,GAAc,CAC5D,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAM,KAC3B,iDACA,CACE,UAAWF,CACZ,EACD,CACE,QAAS,CACP,eAAgB,kBACjB,CACF,CACP,EAEI,GAAIC,EAAS,SAAW,IACtB,OAAOA,EAAS,KAElB,MAAM,IAAI,MAAM,MAAM,CACvB,OAAQH,EAAO,CACd,cAAQ,MAAM,cAAeA,CAAK,EAC5B,IAAI,MAAM,eAAeA,EAAM,OAAO,EAAE,CAC/C,CACH,EAGaK,EAAiB,MAAOC,EAAY,KAAU,CACzD,GAAI,CACF,MAAMH,EAAW,MAAMC,EAAM,IAC3B,6CACA,CACE,QAAS,CACP,eAAgB,kBACjB,CACF,CACP,EAEI,GAAID,EAAS,KAAK,OAAS,GAAKA,EAAS,KAAK,KAC5C,GAAIG,EAAW,CAEb,MAAMC,EAAeJ,EAAS,KAAK,KAAK,IAAKK,GAAYA,EAAQ,IAAI,EACrE,eAAQ,IAAI,QAAQD,EAAa,MAAM,QAAQ,EACxCA,CACf,KAEQ,QAAOJ,EAAS,KAAK,SAGvB,OAAM,IAAI,MAAMA,EAAS,KAAK,KAAO,UAAU,CAElD,OAAQH,EAAO,CACd,cAAQ,MAAM,YAAaA,CAAK,EAC1B,IAAI,MAAM,aAAaA,EAAM,OAAO,EAAE,CAC7C,CACH,EAQaS,EAAoB,SAAY,CAC3C,GAAI,CACF,MAAMN,EAAW,MAAMC,EAAM,IAC3B,8DACA,CACE,OAAQ,CACN,UAAW,MACX,cAAe,CAChB,EACD,QAAS,GACV,CACP,EAEI,GACED,EAAS,MACTA,EAAS,KAAK,YAAc,GAC5BA,EAAS,KAAK,OACd,CAIA,MAAMO,EAAa,CAAC,GAHPP,EAAS,KAAK,MAGA,EAAE,KAAK,CAAC,EAAGQ,IAAMA,EAAE,SAAW,EAAE,QAAQ,EAG7DC,EAAYF,EAAW,MAAM,EAAG,EAAE,EAAE,IAAKG,IAAU,CACvD,KAAMA,EAAK,UACX,KAAMA,EAAK,UAAU,SAAU,EAC/B,cAAe,WAAWA,EAAK,UAAY,CAAC,EAAE,QAAQ,CAAC,CACxD,EAAC,EAGIC,EAAaJ,EAChB,MAAM,GAAG,EACT,QAAS,EACT,IAAKG,IAAU,CACd,KAAMA,EAAK,UACX,KAAMA,EAAK,UAAU,SAAU,EAC/B,cAAe,WAAWA,EAAK,UAAY,CAAC,EAAE,QAAQ,CAAC,CACxD,EAAC,EAEJ,MAAO,CACL,UAAAD,EACA,WAAAE,EACA,UAAW,IAAI,KAAM,EAAC,YAAa,CAC3C,CACA,KACM,gBAAQ,KAAK,kBAAkB,EACxB,CACL,UAAW,CAAE,EACb,WAAY,CAAE,EACd,UAAW,IAAI,KAAM,EAAC,YAAa,CAC3C,CAEG,OAAQd,EAAO,CACd,eAAQ,MAAM,cAAeA,CAAK,EAE3B,CACL,UAAW,CAAE,EACb,WAAY,CAAE,EACd,UAAW,IAAI,KAAM,EAAC,YAAa,EACnC,MAAOA,EAAM,OACnB,CACG,CACH"}